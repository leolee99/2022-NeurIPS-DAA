Namespace(batch_size=128, bi_gru=True, data_name='coco_precomp', data_path='../data', embed_size=1024, grad_clip=2.0, img_dim=2048, learning_rate=0.0006, local_rank=0, log_step=10, logger_name='./log', lr_update=20, margin=0.2, max_violation=True, model_name='./runs/COCO_SGR/checkpoint/ex15', module_name='SGR', no_imgnorm=False, no_txtnorm=False, num_epochs=30, num_layers=1, sgr_step=3, sim_dim=256, val_step=1107, vocab_path='vocab/', vocab_size=11353, word_dim=300, workers=0)
Loading dataset
../SGRAF/data/coco_precomp/CIDEr_testall.h5
=> loaded checkpoint_epoch 28
Computing results...
Images: 5000, Captions: 25000
>> shard_attn_scores batch (0,0)>> shard_attn_scores batch (0,1)>> shard_attn_scores batch (0,2)>> shard_attn_scores batch (0,3)>> shard_attn_scores batch (0,4)>> shard_attn_scores batch (0,5)>> shard_attn_scores batch (0,6)>> shard_attn_scores batch (0,7)>> shard_attn_scores batch (0,8)>> shard_attn_scores batch (0,9)>> shard_attn_scores batch (0,10)>> shard_attn_scores batch (0,11)>> shard_attn_scores batch (0,12)>> shard_attn_scores batch (0,13)>> shard_attn_scores batch (0,14)>> shard_attn_scores batch (0,15)>> shard_attn_scores batch (0,16)>> shard_attn_scores batch (0,17)>> shard_attn_scores batch (0,18)>> shard_attn_scores batch (0,19)>> shard_attn_scores batch (0,20)>> shard_attn_scores batch (0,21)>> shard_attn_scores batch (0,22)>> shard_attn_scores batch (0,23)>> shard_attn_scores batch (0,24)>> shard_attn_scores batch (0,25)>> shard_attn_scores batch (0,26)>> shard_attn_scores batch (0,27)>> shard_attn_scores batch (0,28)>> shard_attn_scores batch (0,29)>> shard_attn_scores batch (0,30)>> shard_attn_scores batch (0,31)>> shard_attn_scores batch (0,32)>> shard_attn_scores batch (0,33)>> shard_attn_scores batch (0,34)>> shard_attn_scores batch (0,35)>> shard_attn_scores batch (0,36)>> shard_attn_scores batch (0,37)>> shard_attn_scores batch (0,38)>> shard_attn_scores batch (0,39)>> shard_attn_scores batch (0,40)>> shard_attn_scores batch (0,41)>> shard_attn_scores batch (0,42)>> shard_attn_scores batch (0,43)>> shard_attn_scores batch (0,44)>> shard_attn_scores batch (0,45)>> shard_attn_scores batch (0,46)>> shard_attn_scores batch (0,47)>> shard_attn_scores batch (0,48)>> shard_attn_scores batch (0,49)>> shard_attn_scores batch (1,0)>> shard_attn_scores batch (1,1)>> shard_attn_scores batch (1,2)>> shard_attn_scores batch (1,3)>> shard_attn_scores batch (1,4)>> shard_attn_scores batch (1,5)>> shard_attn_scores batch (1,6)>> shard_attn_scores batch (1,7)>> shard_attn_scores batch (1,8)>> shard_attn_scores batch (1,9)>> shard_attn_scores batch (1,10)>> shard_attn_scores batch (1,11)>> shard_attn_scores batch (1,12)>> shard_attn_scores batch (1,13)>> shard_attn_scores batch (1,14)>> shard_attn_scores batch (1,15)>> shard_attn_scores batch (1,16)>> shard_attn_scores batch (1,17)>> shard_attn_scores batch (1,18)>> shard_attn_scores batch (1,19)>> shard_attn_scores batch (1,20)>> shard_attn_scores batch (1,21)>> shard_attn_scores batch (1,22)>> shard_attn_scores batch (1,23)>> shard_attn_scores batch (1,24)>> shard_attn_scores batch (1,25)>> shard_attn_scores batch (1,26)>> shard_attn_scores batch (1,27)>> shard_attn_scores batch (1,28)>> shard_attn_scores batch (1,29)>> shard_attn_scores batch (1,30)>> shard_attn_scores batch (1,31)>> shard_attn_scores batch (1,32)>> shard_attn_scores batch (1,33)>> shard_attn_scores batch (1,34)>> shard_attn_scores batch (1,35)>> shard_attn_scores batch (1,36)>> shard_attn_scores batch (1,37)>> shard_attn_scores batch (1,38)>> shard_attn_scores batch (1,39)>> shard_attn_scores batch (1,40)>> shard_attn_scores batch (1,41)>> shard_attn_scores batch (1,42)>> shard_attn_scores batch (1,43)>> shard_attn_scores batch (1,44)>> shard_attn_scores batch (1,45)>> shard_attn_scores batch (1,46)>> shard_attn_scores batch (1,47)>> shard_attn_scores batch (1,48)>> shard_attn_scores batch (1,49)>> shard_attn_scores batch (2,0)>> shard_attn_scores batch (2,1)>> shard_attn_scores batch (2,2)>> shard_attn_scores batch (2,3)>> shard_attn_scores batch (2,4)>> shard_attn_scores batch (2,5)>> shard_attn_scores batch (2,6)>> shard_attn_scores batch (2,7)>> shard_attn_scores batch (2,8)>> shard_attn_scores batch (2,9)>> shard_attn_scores batch (2,10)>> shard_attn_scores batch (2,11)>> shard_attn_scores batch (2,12)>> shard_attn_scores batch (2,13)>> shard_attn_scores batch (2,14)>> shard_attn_scores batch (2,15)>> shard_attn_scores batch (2,16)>> shard_attn_scores batch (2,17)>> shard_attn_scores batch (2,18)>> shard_attn_scores batch (2,19)>> shard_attn_scores batch (2,20)>> shard_attn_scores batch (2,21)>> shard_attn_scores batch (2,22)>> shard_attn_scores batch (2,23)>> shard_attn_scores batch (2,24)>> shard_attn_scores batch (2,25)>> shard_attn_scores batch (2,26)>> shard_attn_scores batch (2,27)>> shard_attn_scores batch (2,28)>> shard_attn_scores batch (2,29)>> shard_attn_scores batch (2,30)>> shard_attn_scores batch (2,31)>> shard_attn_scores batch (2,32)>> shard_attn_scores batch (2,33)>> shard_attn_scores batch (2,34)>> shard_attn_scores batch (2,35)>> shard_attn_scores batch (2,36)>> shard_attn_scores batch (2,37)>> shard_attn_scores batch (2,38)>> shard_attn_scores batch (2,39)>> shard_attn_scores batch (2,40)>> shard_attn_scores batch (2,41)>> shard_attn_scores batch (2,42)>> shard_attn_scores batch (2,43)>> shard_attn_scores batch (2,44)>> shard_attn_scores batch (2,45)>> shard_attn_scores batch (2,46)>> shard_attn_scores batch (2,47)>> shard_attn_scores batch (2,48)>> shard_attn_scores batch (2,49)>> shard_attn_scores batch (3,0)>> shard_attn_scores batch (3,1)>> shard_attn_scores batch (3,2)>> shard_attn_scores batch (3,3)>> shard_attn_scores batch (3,4)>> shard_attn_scores batch (3,5)>> shard_attn_scores batch (3,6)>> shard_attn_scores batch (3,7)>> shard_attn_scores batch (3,8)>> shard_attn_scores batch (3,9)>> shard_attn_scores batch (3,10)>> shard_attn_scores batch (3,11)>> shard_attn_scores batch (3,12)>> shard_attn_scores batch (3,13)>> shard_attn_scores batch (3,14)>> shard_attn_scores batch (3,15)>> shard_attn_scores batch (3,16)>> shard_attn_scores batch (3,17)>> shard_attn_scores batch (3,18)>> shard_attn_scores batch (3,19)>> shard_attn_scores batch (3,20)>> shard_attn_scores batch (3,21)>> shard_attn_scores batch (3,22)>> shard_attn_scores batch (3,23)>> shard_attn_scores batch (3,24)>> shard_attn_scores batch (3,25)>> shard_attn_scores batch (3,26)>> shard_attn_scores batch (3,27)>> shard_attn_scores batch (3,28)>> shard_attn_scores batch (3,29)>> shard_attn_scores batch (3,30)>> shard_attn_scores batch (3,31)>> shard_attn_scores batch (3,32)>> shard_attn_scores batch (3,33)>> shard_attn_scores batch (3,34)>> shard_attn_scores batch (3,35)>> shard_attn_scores batch (3,36)>> shard_attn_scores batch (3,37)>> shard_attn_scores batch (3,38)>> shard_attn_scores batch (3,39)>> shard_attn_scores batch (3,40)>> shard_attn_scores batch (3,41)>> shard_attn_scores batch (3,42)>> shard_attn_scores batch (3,43)>> shard_attn_scores batch (3,44)>> shard_attn_scores batch (3,45)>> shard_attn_scores batch (3,46)>> shard_attn_scores batch (3,47)>> shard_attn_scores batch (3,48)>> shard_attn_scores batch (3,49)>> shard_attn_scores batch (4,0)>> shard_attn_scores batch (4,1)>> shard_attn_scores batch (4,2)>> shard_attn_scores batch (4,3)>> shard_attn_scores batch (4,4)>> shard_attn_scores batch (4,5)>> shard_attn_scores batch (4,6)>> shard_attn_scores batch (4,7)>> shard_attn_scores batch (4,8)>> shard_attn_scores batch (4,9)>> shard_attn_scores batch (4,10)>> shard_attn_scores batch (4,11)>> shard_attn_scores batch (4,12)>> shard_attn_scores batch (4,13)>> shard_attn_scores batch (4,14)>> shard_attn_scores batch (4,15)>> shard_attn_scores batch (4,16)>> shard_attn_scores batch (4,17)>> shard_attn_scores batch (4,18)>> shard_attn_scores batch (4,19)>> shard_attn_scores batch (4,20)>> shard_attn_scores batch (4,21)>> shard_attn_scores batch (4,22)>> shard_attn_scores batch (4,23)>> shard_attn_scores batch (4,24)>> shard_attn_scores batch (4,25)>> shard_attn_scores batch (4,26)>> shard_attn_scores batch (4,27)>> shard_attn_scores batch (4,28)>> shard_attn_scores batch (4,29)>> shard_attn_scores batch (4,30)>> shard_attn_scores batch (4,31)>> shard_attn_scores batch (4,32)>> shard_attn_scores batch (4,33)>> shard_attn_scores batch (4,34)>> shard_attn_scores batch (4,35)>> shard_attn_scores batch (4,36)>> shard_attn_scores batch (4,37)>> shard_attn_scores batch (4,38)>> shard_attn_scores batch (4,39)>> shard_attn_scores batch (4,40)>> shard_attn_scores batch (4,41)>> shard_attn_scores batch (4,42)>> shard_attn_scores batch (4,43)>> shard_attn_scores batch (4,44)>> shard_attn_scores batch (4,45)>> shard_attn_scores batch (4,46)>> shard_attn_scores batch (4,47)>> shard_attn_scores batch (4,48)>> shard_attn_scores batch (4,49)>> shard_attn_scores batch (5,0)>> shard_attn_scores batch (5,1)>> shard_attn_scores batch (5,2)>> shard_attn_scores batch (5,3)>> shard_attn_scores batch (5,4)>> shard_attn_scores batch (5,5)>> shard_attn_scores batch (5,6)>> shard_attn_scores batch (5,7)>> shard_attn_scores batch (5,8)>> shard_attn_scores batch (5,9)>> shard_attn_scores batch (5,10)>> shard_attn_scores batch (5,11)>> shard_attn_scores batch (5,12)>> shard_attn_scores batch (5,13)>> shard_attn_scores batch (5,14)>> shard_attn_scores batch (5,15)>> shard_attn_scores batch (5,16)>> shard_attn_scores batch (5,17)>> shard_attn_scores batch (5,18)>> shard_attn_scores batch (5,19)>> shard_attn_scores batch (5,20)>> shard_attn_scores batch (5,21)>> shard_attn_scores batch (5,22)>> shard_attn_scores batch (5,23)>> shard_attn_scores batch (5,24)>> shard_attn_scores batch (5,25)>> shard_attn_scores batch (5,26)>> shard_attn_scores batch (5,27)>> shard_attn_scores batch (5,28)>> shard_attn_scores batch (5,29)>> shard_attn_scores batch (5,30)>> shard_attn_scores batch (5,31)>> shard_attn_scores batch (5,32)>> shard_attn_scores batch (5,33)>> shard_attn_scores batch (5,34)>> shard_attn_scores batch (5,35)>> shard_attn_scores batch (5,36)>> shard_attn_scores batch (5,37)>> shard_attn_scores batch (5,38)>> shard_attn_scores batch (5,39)>> shard_attn_scores batch (5,40)>> shard_attn_scores batch (5,41)>> shard_attn_scores batch (5,42)>> shard_attn_scores batch (5,43)>> shard_attn_scores batch (5,44)>> shard_attn_scores batch (5,45)>> shard_attn_scores batch (5,46)>> shard_attn_scores batch (5,47)>> shard_attn_scores batch (5,48)>> shard_attn_scores batch (5,49)>> shard_attn_scores batch (6,0)>> shard_attn_scores batch (6,1)>> shard_attn_scores batch (6,2)>> shard_attn_scores batch (6,3)>> shard_attn_scores batch (6,4)>> shard_attn_scores batch (6,5)>> shard_attn_scores batch (6,6)>> shard_attn_scores batch (6,7)>> shard_attn_scores batch (6,8)>> shard_attn_scores batch (6,9)>> shard_attn_scores batch (6,10)>> shard_attn_scores batch (6,11)>> shard_attn_scores batch (6,12)>> shard_attn_scores batch (6,13)>> shard_attn_scores batch (6,14)>> shard_attn_scores batch (6,15)>> shard_attn_scores batch (6,16)>> shard_attn_scores batch (6,17)>> shard_attn_scores batch (6,18)>> shard_attn_scores batch (6,19)>> shard_attn_scores batch (6,20)>> shard_attn_scores batch (6,21)>> shard_attn_scores batch (6,22)>> shard_attn_scores batch (6,23)>> shard_attn_scores batch (6,24)>> shard_attn_scores batch (6,25)>> shard_attn_scores batch (6,26)>> shard_attn_scores batch (6,27)>> shard_attn_scores batch (6,28)>> shard_attn_scores batch (6,29)>> shard_attn_scores batch (6,30)>> shard_attn_scores batch (6,31)>> shard_attn_scores batch (6,32)>> shard_attn_scores batch (6,33)>> shard_attn_scores batch (6,34)>> shard_attn_scores batch (6,35)>> shard_attn_scores batch (6,36)>> shard_attn_scores batch (6,37)>> shard_attn_scores batch (6,38)>> shard_attn_scores batch (6,39)>> shard_attn_scores batch (6,40)>> shard_attn_scores batch (6,41)>> shard_attn_scores batch (6,42)>> shard_attn_scores batch (6,43)>> shard_attn_scores batch (6,44)>> shard_attn_scores batch (6,45)>> shard_attn_scores batch (6,46)>> shard_attn_scores batch (6,47)>> shard_attn_scores batch (6,48)>> shard_attn_scores batch (6,49)>> shard_attn_scores batch (7,0)>> shard_attn_scores batch (7,1)>> shard_attn_scores batch (7,2)>> shard_attn_scores batch (7,3)>> shard_attn_scores batch (7,4)>> shard_attn_scores batch (7,5)>> shard_attn_scores batch (7,6)>> shard_attn_scores batch (7,7)>> shard_attn_scores batch (7,8)>> shard_attn_scores batch (7,9)>> shard_attn_scores batch (7,10)>> shard_attn_scores batch (7,11)>> shard_attn_scores batch (7,12)>> shard_attn_scores batch (7,13)>> shard_attn_scores batch (7,14)>> shard_attn_scores batch (7,15)>> shard_attn_scores batch (7,16)>> shard_attn_scores batch (7,17)>> shard_attn_scores batch (7,18)>> shard_attn_scores batch (7,19)>> shard_attn_scores batch (7,20)>> shard_attn_scores batch (7,21)>> shard_attn_scores batch (7,22)>> shard_attn_scores batch (7,23)>> shard_attn_scores batch (7,24)>> shard_attn_scores batch (7,25)>> shard_attn_scores batch (7,26)>> shard_attn_scores batch (7,27)>> shard_attn_scores batch (7,28)>> shard_attn_scores batch (7,29)>> shard_attn_scores batch (7,30)>> shard_attn_scores batch (7,31)>> shard_attn_scores batch (7,32)>> shard_attn_scores batch (7,33)>> shard_attn_scores batch (7,34)>> shard_attn_scores batch (7,35)>> shard_attn_scores batch (7,36)>> shard_attn_scores batch (7,37)>> shard_attn_scores batch (7,38)>> shard_attn_scores batch (7,39)>> shard_attn_scores batch (7,40)>> shard_attn_scores batch (7,41)>> shard_attn_scores batch (7,42)>> shard_attn_scores batch (7,43)>> shard_attn_scores batch (7,44)>> shard_attn_scores batch (7,45)>> shard_attn_scores batch (7,46)>> shard_attn_scores batch (7,47)>> shard_attn_scores batch (7,48)>> shard_attn_scores batch (7,49)>> shard_attn_scores batch (8,0)>> shard_attn_scores batch (8,1)>> shard_attn_scores batch (8,2)>> shard_attn_scores batch (8,3)>> shard_attn_scores batch (8,4)>> shard_attn_scores batch (8,5)>> shard_attn_scores batch (8,6)>> shard_attn_scores batch (8,7)>> shard_attn_scores batch (8,8)>> shard_attn_scores batch (8,9)>> shard_attn_scores batch (8,10)>> shard_attn_scores batch (8,11)>> shard_attn_scores batch (8,12)>> shard_attn_scores batch (8,13)>> shard_attn_scores batch (8,14)>> shard_attn_scores batch (8,15)>> shard_attn_scores batch (8,16)>> shard_attn_scores batch (8,17)>> shard_attn_scores batch (8,18)>> shard_attn_scores batch (8,19)>> shard_attn_scores batch (8,20)>> shard_attn_scores batch (8,21)>> shard_attn_scores batch (8,22)>> shard_attn_scores batch (8,23)>> shard_attn_scores batch (8,24)>> shard_attn_scores batch (8,25)>> shard_attn_scores batch (8,26)>> shard_attn_scores batch (8,27)>> shard_attn_scores batch (8,28)>> shard_attn_scores batch (8,29)>> shard_attn_scores batch (8,30)>> shard_attn_scores batch (8,31)>> shard_attn_scores batch (8,32)>> shard_attn_scores batch (8,33)>> shard_attn_scores batch (8,34)>> shard_attn_scores batch (8,35)>> shard_attn_scores batch (8,36)>> shard_attn_scores batch (8,37)>> shard_attn_scores batch (8,38)>> shard_attn_scores batch (8,39)>> shard_attn_scores batch (8,40)>> shard_attn_scores batch (8,41)>> shard_attn_scores batch (8,42)>> shard_attn_scores batch (8,43)>> shard_attn_scores batch (8,44)>> shard_attn_scores batch (8,45)>> shard_attn_scores batch (8,46)>> shard_attn_scores batch (8,47)>> shard_attn_scores batch (8,48)>> shard_attn_scores batch (8,49)>> shard_attn_scores batch (9,0)>> shard_attn_scores batch (9,1)>> shard_attn_scores batch (9,2)>> shard_attn_scores batch (9,3)>> shard_attn_scores batch (9,4)>> shard_attn_scores batch (9,5)>> shard_attn_scores batch (9,6)>> shard_attn_scores batch (9,7)>> shard_attn_scores batch (9,8)>> shard_attn_scores batch (9,9)>> shard_attn_scores batch (9,10)>> shard_attn_scores batch (9,11)>> shard_attn_scores batch (9,12)>> shard_attn_scores batch (9,13)>> shard_attn_scores batch (9,14)>> shard_attn_scores batch (9,15)>> shard_attn_scores batch (9,16)>> shard_attn_scores batch (9,17)>> shard_attn_scores batch (9,18)>> shard_attn_scores batch (9,19)>> shard_attn_scores batch (9,20)>> shard_attn_scores batch (9,21)>> shard_attn_scores batch (9,22)>> shard_attn_scores batch (9,23)>> shard_attn_scores batch (9,24)>> shard_attn_scores batch (9,25)>> shard_attn_scores batch (9,26)>> shard_attn_scores batch (9,27)>> shard_attn_scores batch (9,28)>> shard_attn_scores batch (9,29)>> shard_attn_scores batch (9,30)>> shard_attn_scores batch (9,31)>> shard_attn_scores batch (9,32)>> shard_attn_scores batch (9,33)>> shard_attn_scores batch (9,34)>> shard_attn_scores batch (9,35)>> shard_attn_scores batch (9,36)>> shard_attn_scores batch (9,37)>> shard_attn_scores batch (9,38)>> shard_attn_scores batch (9,39)>> shard_attn_scores batch (9,40)>> shard_attn_scores batch (9,41)>> shard_attn_scores batch (9,42)>> shard_attn_scores batch (9,43)>> shard_attn_scores batch (9,44)>> shard_attn_scores batch (9,45)>> shard_attn_scores batch (9,46)>> shard_attn_scores batch (9,47)>> shard_attn_scores batch (9,48)>> shard_attn_scores batch (9,49)
calculate similarity time: 147.1204640865326
Image to text: 80.2 96.8 98.8 1.0 1.6 68.4
Text to image: 65.0 89.8 93.9 1.0 9.2 62.7
rsum: 524.6 ar: 91.9 ari: 82.9
>> shard_attn_scores batch (0,0)>> shard_attn_scores batch (0,1)>> shard_attn_scores batch (0,2)>> shard_attn_scores batch (0,3)>> shard_attn_scores batch (0,4)>> shard_attn_scores batch (0,5)>> shard_attn_scores batch (0,6)>> shard_attn_scores batch (0,7)>> shard_attn_scores batch (0,8)>> shard_attn_scores batch (0,9)>> shard_attn_scores batch (0,10)>> shard_attn_scores batch (0,11)>> shard_attn_scores batch (0,12)>> shard_attn_scores batch (0,13)>> shard_attn_scores batch (0,14)>> shard_attn_scores batch (0,15)>> shard_attn_scores batch (0,16)>> shard_attn_scores batch (0,17)>> shard_attn_scores batch (0,18)>> shard_attn_scores batch (0,19)>> shard_attn_scores batch (0,20)>> shard_attn_scores batch (0,21)>> shard_attn_scores batch (0,22)>> shard_attn_scores batch (0,23)>> shard_attn_scores batch (0,24)>> shard_attn_scores batch (0,25)>> shard_attn_scores batch (0,26)>> shard_attn_scores batch (0,27)>> shard_attn_scores batch (0,28)>> shard_attn_scores batch (0,29)>> shard_attn_scores batch (0,30)>> shard_attn_scores batch (0,31)>> shard_attn_scores batch (0,32)>> shard_attn_scores batch (0,33)>> shard_attn_scores batch (0,34)>> shard_attn_scores batch (0,35)>> shard_attn_scores batch (0,36)>> shard_attn_scores batch (0,37)>> shard_attn_scores batch (0,38)>> shard_attn_scores batch (0,39)>> shard_attn_scores batch (0,40)>> shard_attn_scores batch (0,41)>> shard_attn_scores batch (0,42)>> shard_attn_scores batch (0,43)>> shard_attn_scores batch (0,44)>> shard_attn_scores batch (0,45)>> shard_attn_scores batch (0,46)>> shard_attn_scores batch (0,47)>> shard_attn_scores batch (0,48)>> shard_attn_scores batch (0,49)>> shard_attn_scores batch (1,0)>> shard_attn_scores batch (1,1)>> shard_attn_scores batch (1,2)>> shard_attn_scores batch (1,3)>> shard_attn_scores batch (1,4)>> shard_attn_scores batch (1,5)>> shard_attn_scores batch (1,6)>> shard_attn_scores batch (1,7)>> shard_attn_scores batch (1,8)>> shard_attn_scores batch (1,9)>> shard_attn_scores batch (1,10)>> shard_attn_scores batch (1,11)>> shard_attn_scores batch (1,12)>> shard_attn_scores batch (1,13)>> shard_attn_scores batch (1,14)>> shard_attn_scores batch (1,15)>> shard_attn_scores batch (1,16)>> shard_attn_scores batch (1,17)>> shard_attn_scores batch (1,18)>> shard_attn_scores batch (1,19)>> shard_attn_scores batch (1,20)>> shard_attn_scores batch (1,21)>> shard_attn_scores batch (1,22)>> shard_attn_scores batch (1,23)>> shard_attn_scores batch (1,24)>> shard_attn_scores batch (1,25)>> shard_attn_scores batch (1,26)>> shard_attn_scores batch (1,27)>> shard_attn_scores batch (1,28)>> shard_attn_scores batch (1,29)>> shard_attn_scores batch (1,30)>> shard_attn_scores batch (1,31)>> shard_attn_scores batch (1,32)>> shard_attn_scores batch (1,33)>> shard_attn_scores batch (1,34)>> shard_attn_scores batch (1,35)>> shard_attn_scores batch (1,36)>> shard_attn_scores batch (1,37)>> shard_attn_scores batch (1,38)>> shard_attn_scores batch (1,39)>> shard_attn_scores batch (1,40)>> shard_attn_scores batch (1,41)>> shard_attn_scores batch (1,42)>> shard_attn_scores batch (1,43)>> shard_attn_scores batch (1,44)>> shard_attn_scores batch (1,45)>> shard_attn_scores batch (1,46)>> shard_attn_scores batch (1,47)>> shard_attn_scores batch (1,48)>> shard_attn_scores batch (1,49)>> shard_attn_scores batch (2,0)>> shard_attn_scores batch (2,1)>> shard_attn_scores batch (2,2)>> shard_attn_scores batch (2,3)>> shard_attn_scores batch (2,4)>> shard_attn_scores batch (2,5)>> shard_attn_scores batch (2,6)>> shard_attn_scores batch (2,7)>> shard_attn_scores batch (2,8)>> shard_attn_scores batch (2,9)>> shard_attn_scores batch (2,10)>> shard_attn_scores batch (2,11)>> shard_attn_scores batch (2,12)>> shard_attn_scores batch (2,13)>> shard_attn_scores batch (2,14)>> shard_attn_scores batch (2,15)>> shard_attn_scores batch (2,16)>> shard_attn_scores batch (2,17)>> shard_attn_scores batch (2,18)>> shard_attn_scores batch (2,19)>> shard_attn_scores batch (2,20)>> shard_attn_scores batch (2,21)>> shard_attn_scores batch (2,22)>> shard_attn_scores batch (2,23)>> shard_attn_scores batch (2,24)>> shard_attn_scores batch (2,25)>> shard_attn_scores batch (2,26)>> shard_attn_scores batch (2,27)>> shard_attn_scores batch (2,28)>> shard_attn_scores batch (2,29)>> shard_attn_scores batch (2,30)>> shard_attn_scores batch (2,31)>> shard_attn_scores batch (2,32)>> shard_attn_scores batch (2,33)>> shard_attn_scores batch (2,34)>> shard_attn_scores batch (2,35)>> shard_attn_scores batch (2,36)>> shard_attn_scores batch (2,37)>> shard_attn_scores batch (2,38)>> shard_attn_scores batch (2,39)>> shard_attn_scores batch (2,40)>> shard_attn_scores batch (2,41)>> shard_attn_scores batch (2,42)>> shard_attn_scores batch (2,43)>> shard_attn_scores batch (2,44)>> shard_attn_scores batch (2,45)>> shard_attn_scores batch (2,46)>> shard_attn_scores batch (2,47)>> shard_attn_scores batch (2,48)>> shard_attn_scores batch (2,49)>> shard_attn_scores batch (3,0)>> shard_attn_scores batch (3,1)>> shard_attn_scores batch (3,2)>> shard_attn_scores batch (3,3)>> shard_attn_scores batch (3,4)>> shard_attn_scores batch (3,5)>> shard_attn_scores batch (3,6)>> shard_attn_scores batch (3,7)>> shard_attn_scores batch (3,8)>> shard_attn_scores batch (3,9)>> shard_attn_scores batch (3,10)>> shard_attn_scores batch (3,11)>> shard_attn_scores batch (3,12)>> shard_attn_scores batch (3,13)>> shard_attn_scores batch (3,14)>> shard_attn_scores batch (3,15)>> shard_attn_scores batch (3,16)>> shard_attn_scores batch (3,17)>> shard_attn_scores batch (3,18)>> shard_attn_scores batch (3,19)>> shard_attn_scores batch (3,20)>> shard_attn_scores batch (3,21)>> shard_attn_scores batch (3,22)>> shard_attn_scores batch (3,23)>> shard_attn_scores batch (3,24)>> shard_attn_scores batch (3,25)>> shard_attn_scores batch (3,26)>> shard_attn_scores batch (3,27)>> shard_attn_scores batch (3,28)>> shard_attn_scores batch (3,29)>> shard_attn_scores batch (3,30)>> shard_attn_scores batch (3,31)>> shard_attn_scores batch (3,32)>> shard_attn_scores batch (3,33)>> shard_attn_scores batch (3,34)>> shard_attn_scores batch (3,35)>> shard_attn_scores batch (3,36)>> shard_attn_scores batch (3,37)>> shard_attn_scores batch (3,38)>> shard_attn_scores batch (3,39)>> shard_attn_scores batch (3,40)>> shard_attn_scores batch (3,41)>> shard_attn_scores batch (3,42)>> shard_attn_scores batch (3,43)>> shard_attn_scores batch (3,44)>> shard_attn_scores batch (3,45)>> shard_attn_scores batch (3,46)>> shard_attn_scores batch (3,47)>> shard_attn_scores batch (3,48)>> shard_attn_scores batch (3,49)>> shard_attn_scores batch (4,0)>> shard_attn_scores batch (4,1)>> shard_attn_scores batch (4,2)>> shard_attn_scores batch (4,3)>> shard_attn_scores batch (4,4)>> shard_attn_scores batch (4,5)>> shard_attn_scores batch (4,6)>> shard_attn_scores batch (4,7)>> shard_attn_scores batch (4,8)>> shard_attn_scores batch (4,9)>> shard_attn_scores batch (4,10)>> shard_attn_scores batch (4,11)>> shard_attn_scores batch (4,12)>> shard_attn_scores batch (4,13)>> shard_attn_scores batch (4,14)>> shard_attn_scores batch (4,15)>> shard_attn_scores batch (4,16)>> shard_attn_scores batch (4,17)>> shard_attn_scores batch (4,18)>> shard_attn_scores batch (4,19)>> shard_attn_scores batch (4,20)>> shard_attn_scores batch (4,21)>> shard_attn_scores batch (4,22)>> shard_attn_scores batch (4,23)>> shard_attn_scores batch (4,24)>> shard_attn_scores batch (4,25)>> shard_attn_scores batch (4,26)>> shard_attn_scores batch (4,27)>> shard_attn_scores batch (4,28)>> shard_attn_scores batch (4,29)>> shard_attn_scores batch (4,30)>> shard_attn_scores batch (4,31)>> shard_attn_scores batch (4,32)>> shard_attn_scores batch (4,33)>> shard_attn_scores batch (4,34)>> shard_attn_scores batch (4,35)>> shard_attn_scores batch (4,36)>> shard_attn_scores batch (4,37)>> shard_attn_scores batch (4,38)>> shard_attn_scores batch (4,39)>> shard_attn_scores batch (4,40)>> shard_attn_scores batch (4,41)>> shard_attn_scores batch (4,42)>> shard_attn_scores batch (4,43)>> shard_attn_scores batch (4,44)>> shard_attn_scores batch (4,45)>> shard_attn_scores batch (4,46)>> shard_attn_scores batch (4,47)>> shard_attn_scores batch (4,48)>> shard_attn_scores batch (4,49)>> shard_attn_scores batch (5,0)>> shard_attn_scores batch (5,1)>> shard_attn_scores batch (5,2)>> shard_attn_scores batch (5,3)>> shard_attn_scores batch (5,4)>> shard_attn_scores batch (5,5)>> shard_attn_scores batch (5,6)>> shard_attn_scores batch (5,7)>> shard_attn_scores batch (5,8)>> shard_attn_scores batch (5,9)>> shard_attn_scores batch (5,10)>> shard_attn_scores batch (5,11)>> shard_attn_scores batch (5,12)>> shard_attn_scores batch (5,13)>> shard_attn_scores batch (5,14)>> shard_attn_scores batch (5,15)>> shard_attn_scores batch (5,16)>> shard_attn_scores batch (5,17)>> shard_attn_scores batch (5,18)>> shard_attn_scores batch (5,19)>> shard_attn_scores batch (5,20)>> shard_attn_scores batch (5,21)>> shard_attn_scores batch (5,22)>> shard_attn_scores batch (5,23)>> shard_attn_scores batch (5,24)>> shard_attn_scores batch (5,25)>> shard_attn_scores batch (5,26)>> shard_attn_scores batch (5,27)>> shard_attn_scores batch (5,28)>> shard_attn_scores batch (5,29)>> shard_attn_scores batch (5,30)>> shard_attn_scores batch (5,31)>> shard_attn_scores batch (5,32)>> shard_attn_scores batch (5,33)>> shard_attn_scores batch (5,34)>> shard_attn_scores batch (5,35)>> shard_attn_scores batch (5,36)>> shard_attn_scores batch (5,37)>> shard_attn_scores batch (5,38)>> shard_attn_scores batch (5,39)>> shard_attn_scores batch (5,40)>> shard_attn_scores batch (5,41)>> shard_attn_scores batch (5,42)>> shard_attn_scores batch (5,43)>> shard_attn_scores batch (5,44)>> shard_attn_scores batch (5,45)>> shard_attn_scores batch (5,46)>> shard_attn_scores batch (5,47)>> shard_attn_scores batch (5,48)>> shard_attn_scores batch (5,49)>> shard_attn_scores batch (6,0)>> shard_attn_scores batch (6,1)>> shard_attn_scores batch (6,2)>> shard_attn_scores batch (6,3)>> shard_attn_scores batch (6,4)>> shard_attn_scores batch (6,5)>> shard_attn_scores batch (6,6)>> shard_attn_scores batch (6,7)>> shard_attn_scores batch (6,8)>> shard_attn_scores batch (6,9)>> shard_attn_scores batch (6,10)>> shard_attn_scores batch (6,11)>> shard_attn_scores batch (6,12)>> shard_attn_scores batch (6,13)>> shard_attn_scores batch (6,14)>> shard_attn_scores batch (6,15)>> shard_attn_scores batch (6,16)>> shard_attn_scores batch (6,17)>> shard_attn_scores batch (6,18)>> shard_attn_scores batch (6,19)>> shard_attn_scores batch (6,20)>> shard_attn_scores batch (6,21)>> shard_attn_scores batch (6,22)>> shard_attn_scores batch (6,23)>> shard_attn_scores batch (6,24)>> shard_attn_scores batch (6,25)>> shard_attn_scores batch (6,26)>> shard_attn_scores batch (6,27)>> shard_attn_scores batch (6,28)>> shard_attn_scores batch (6,29)>> shard_attn_scores batch (6,30)>> shard_attn_scores batch (6,31)>> shard_attn_scores batch (6,32)>> shard_attn_scores batch (6,33)>> shard_attn_scores batch (6,34)>> shard_attn_scores batch (6,35)>> shard_attn_scores batch (6,36)>> shard_attn_scores batch (6,37)>> shard_attn_scores batch (6,38)>> shard_attn_scores batch (6,39)>> shard_attn_scores batch (6,40)>> shard_attn_scores batch (6,41)>> shard_attn_scores batch (6,42)>> shard_attn_scores batch (6,43)>> shard_attn_scores batch (6,44)>> shard_attn_scores batch (6,45)>> shard_attn_scores batch (6,46)>> shard_attn_scores batch (6,47)>> shard_attn_scores batch (6,48)>> shard_attn_scores batch (6,49)>> shard_attn_scores batch (7,0)>> shard_attn_scores batch (7,1)>> shard_attn_scores batch (7,2)>> shard_attn_scores batch (7,3)>> shard_attn_scores batch (7,4)>> shard_attn_scores batch (7,5)>> shard_attn_scores batch (7,6)>> shard_attn_scores batch (7,7)>> shard_attn_scores batch (7,8)>> shard_attn_scores batch (7,9)>> shard_attn_scores batch (7,10)>> shard_attn_scores batch (7,11)>> shard_attn_scores batch (7,12)>> shard_attn_scores batch (7,13)>> shard_attn_scores batch (7,14)>> shard_attn_scores batch (7,15)>> shard_attn_scores batch (7,16)>> shard_attn_scores batch (7,17)>> shard_attn_scores batch (7,18)>> shard_attn_scores batch (7,19)>> shard_attn_scores batch (7,20)>> shard_attn_scores batch (7,21)>> shard_attn_scores batch (7,22)>> shard_attn_scores batch (7,23)>> shard_attn_scores batch (7,24)>> shard_attn_scores batch (7,25)>> shard_attn_scores batch (7,26)>> shard_attn_scores batch (7,27)>> shard_attn_scores batch (7,28)>> shard_attn_scores batch (7,29)>> shard_attn_scores batch (7,30)>> shard_attn_scores batch (7,31)>> shard_attn_scores batch (7,32)>> shard_attn_scores batch (7,33)>> shard_attn_scores batch (7,34)>> shard_attn_scores batch (7,35)>> shard_attn_scores batch (7,36)>> shard_attn_scores batch (7,37)>> shard_attn_scores batch (7,38)>> shard_attn_scores batch (7,39)>> shard_attn_scores batch (7,40)>> shard_attn_scores batch (7,41)>> shard_attn_scores batch (7,42)>> shard_attn_scores batch (7,43)>> shard_attn_scores batch (7,44)>> shard_attn_scores batch (7,45)>> shard_attn_scores batch (7,46)>> shard_attn_scores batch (7,47)>> shard_attn_scores batch (7,48)>> shard_attn_scores batch (7,49)>> shard_attn_scores batch (8,0)>> shard_attn_scores batch (8,1)>> shard_attn_scores batch (8,2)>> shard_attn_scores batch (8,3)>> shard_attn_scores batch (8,4)>> shard_attn_scores batch (8,5)>> shard_attn_scores batch (8,6)>> shard_attn_scores batch (8,7)>> shard_attn_scores batch (8,8)>> shard_attn_scores batch (8,9)>> shard_attn_scores batch (8,10)>> shard_attn_scores batch (8,11)>> shard_attn_scores batch (8,12)>> shard_attn_scores batch (8,13)>> shard_attn_scores batch (8,14)>> shard_attn_scores batch (8,15)>> shard_attn_scores batch (8,16)>> shard_attn_scores batch (8,17)>> shard_attn_scores batch (8,18)>> shard_attn_scores batch (8,19)>> shard_attn_scores batch (8,20)>> shard_attn_scores batch (8,21)>> shard_attn_scores batch (8,22)>> shard_attn_scores batch (8,23)>> shard_attn_scores batch (8,24)>> shard_attn_scores batch (8,25)>> shard_attn_scores batch (8,26)>> shard_attn_scores batch (8,27)>> shard_attn_scores batch (8,28)>> shard_attn_scores batch (8,29)>> shard_attn_scores batch (8,30)>> shard_attn_scores batch (8,31)>> shard_attn_scores batch (8,32)>> shard_attn_scores batch (8,33)>> shard_attn_scores batch (8,34)>> shard_attn_scores batch (8,35)>> shard_attn_scores batch (8,36)>> shard_attn_scores batch (8,37)>> shard_attn_scores batch (8,38)>> shard_attn_scores batch (8,39)>> shard_attn_scores batch (8,40)>> shard_attn_scores batch (8,41)>> shard_attn_scores batch (8,42)>> shard_attn_scores batch (8,43)>> shard_attn_scores batch (8,44)>> shard_attn_scores batch (8,45)>> shard_attn_scores batch (8,46)>> shard_attn_scores batch (8,47)>> shard_attn_scores batch (8,48)>> shard_attn_scores batch (8,49)>> shard_attn_scores batch (9,0)>> shard_attn_scores batch (9,1)>> shard_attn_scores batch (9,2)>> shard_attn_scores batch (9,3)>> shard_attn_scores batch (9,4)>> shard_attn_scores batch (9,5)>> shard_attn_scores batch (9,6)>> shard_attn_scores batch (9,7)>> shard_attn_scores batch (9,8)>> shard_attn_scores batch (9,9)>> shard_attn_scores batch (9,10)>> shard_attn_scores batch (9,11)>> shard_attn_scores batch (9,12)>> shard_attn_scores batch (9,13)>> shard_attn_scores batch (9,14)>> shard_attn_scores batch (9,15)>> shard_attn_scores batch (9,16)>> shard_attn_scores batch (9,17)>> shard_attn_scores batch (9,18)>> shard_attn_scores batch (9,19)>> shard_attn_scores batch (9,20)>> shard_attn_scores batch (9,21)>> shard_attn_scores batch (9,22)>> shard_attn_scores batch (9,23)>> shard_attn_scores batch (9,24)>> shard_attn_scores batch (9,25)>> shard_attn_scores batch (9,26)>> shard_attn_scores batch (9,27)>> shard_attn_scores batch (9,28)>> shard_attn_scores batch (9,29)>> shard_attn_scores batch (9,30)>> shard_attn_scores batch (9,31)>> shard_attn_scores batch (9,32)>> shard_attn_scores batch (9,33)>> shard_attn_scores batch (9,34)>> shard_attn_scores batch (9,35)>> shard_attn_scores batch (9,36)>> shard_attn_scores batch (9,37)>> shard_attn_scores batch (9,38)>> shard_attn_scores batch (9,39)>> shard_attn_scores batch (9,40)>> shard_attn_scores batch (9,41)>> shard_attn_scores batch (9,42)>> shard_attn_scores batch (9,43)>> shard_attn_scores batch (9,44)>> shard_attn_scores batch (9,45)>> shard_attn_scores batch (9,46)>> shard_attn_scores batch (9,47)>> shard_attn_scores batch (9,48)>> shard_attn_scores batch (9,49)
calculate similarity time: 146.23283624649048
Image to text: 76.3 95.6 98.5 1.0 1.9 68.3
Text to image: 61.6 87.5 93.1 1.0 10.5 62.7
rsum: 512.6 ar: 90.1 ari: 80.7
>> shard_attn_scores batch (0,0)>> shard_attn_scores batch (0,1)>> shard_attn_scores batch (0,2)>> shard_attn_scores batch (0,3)>> shard_attn_scores batch (0,4)>> shard_attn_scores batch (0,5)>> shard_attn_scores batch (0,6)>> shard_attn_scores batch (0,7)>> shard_attn_scores batch (0,8)>> shard_attn_scores batch (0,9)>> shard_attn_scores batch (0,10)>> shard_attn_scores batch (0,11)>> shard_attn_scores batch (0,12)>> shard_attn_scores batch (0,13)>> shard_attn_scores batch (0,14)>> shard_attn_scores batch (0,15)>> shard_attn_scores batch (0,16)>> shard_attn_scores batch (0,17)>> shard_attn_scores batch (0,18)>> shard_attn_scores batch (0,19)>> shard_attn_scores batch (0,20)>> shard_attn_scores batch (0,21)>> shard_attn_scores batch (0,22)>> shard_attn_scores batch (0,23)>> shard_attn_scores batch (0,24)>> shard_attn_scores batch (0,25)>> shard_attn_scores batch (0,26)>> shard_attn_scores batch (0,27)>> shard_attn_scores batch (0,28)>> shard_attn_scores batch (0,29)>> shard_attn_scores batch (0,30)>> shard_attn_scores batch (0,31)>> shard_attn_scores batch (0,32)>> shard_attn_scores batch (0,33)>> shard_attn_scores batch (0,34)>> shard_attn_scores batch (0,35)>> shard_attn_scores batch (0,36)>> shard_attn_scores batch (0,37)>> shard_attn_scores batch (0,38)>> shard_attn_scores batch (0,39)>> shard_attn_scores batch (0,40)>> shard_attn_scores batch (0,41)>> shard_attn_scores batch (0,42)>> shard_attn_scores batch (0,43)>> shard_attn_scores batch (0,44)>> shard_attn_scores batch (0,45)>> shard_attn_scores batch (0,46)>> shard_attn_scores batch (0,47)>> shard_attn_scores batch (0,48)>> shard_attn_scores batch (0,49)>> shard_attn_scores batch (1,0)>> shard_attn_scores batch (1,1)>> shard_attn_scores batch (1,2)>> shard_attn_scores batch (1,3)>> shard_attn_scores batch (1,4)>> shard_attn_scores batch (1,5)>> shard_attn_scores batch (1,6)>> shard_attn_scores batch (1,7)>> shard_attn_scores batch (1,8)>> shard_attn_scores batch (1,9)>> shard_attn_scores batch (1,10)>> shard_attn_scores batch (1,11)>> shard_attn_scores batch (1,12)>> shard_attn_scores batch (1,13)>> shard_attn_scores batch (1,14)>> shard_attn_scores batch (1,15)>> shard_attn_scores batch (1,16)>> shard_attn_scores batch (1,17)>> shard_attn_scores batch (1,18)>> shard_attn_scores batch (1,19)>> shard_attn_scores batch (1,20)>> shard_attn_scores batch (1,21)>> shard_attn_scores batch (1,22)>> shard_attn_scores batch (1,23)>> shard_attn_scores batch (1,24)>> shard_attn_scores batch (1,25)>> shard_attn_scores batch (1,26)>> shard_attn_scores batch (1,27)>> shard_attn_scores batch (1,28)>> shard_attn_scores batch (1,29)>> shard_attn_scores batch (1,30)>> shard_attn_scores batch (1,31)>> shard_attn_scores batch (1,32)>> shard_attn_scores batch (1,33)>> shard_attn_scores batch (1,34)>> shard_attn_scores batch (1,35)>> shard_attn_scores batch (1,36)>> shard_attn_scores batch (1,37)>> shard_attn_scores batch (1,38)>> shard_attn_scores batch (1,39)>> shard_attn_scores batch (1,40)>> shard_attn_scores batch (1,41)>> shard_attn_scores batch (1,42)>> shard_attn_scores batch (1,43)>> shard_attn_scores batch (1,44)>> shard_attn_scores batch (1,45)>> shard_attn_scores batch (1,46)>> shard_attn_scores batch (1,47)>> shard_attn_scores batch (1,48)>> shard_attn_scores batch (1,49)>> shard_attn_scores batch (2,0)>> shard_attn_scores batch (2,1)>> shard_attn_scores batch (2,2)>> shard_attn_scores batch (2,3)>> shard_attn_scores batch (2,4)>> shard_attn_scores batch (2,5)>> shard_attn_scores batch (2,6)>> shard_attn_scores batch (2,7)>> shard_attn_scores batch (2,8)>> shard_attn_scores batch (2,9)>> shard_attn_scores batch (2,10)>> shard_attn_scores batch (2,11)>> shard_attn_scores batch (2,12)>> shard_attn_scores batch (2,13)>> shard_attn_scores batch (2,14)>> shard_attn_scores batch (2,15)>> shard_attn_scores batch (2,16)>> shard_attn_scores batch (2,17)>> shard_attn_scores batch (2,18)>> shard_attn_scores batch (2,19)>> shard_attn_scores batch (2,20)>> shard_attn_scores batch (2,21)>> shard_attn_scores batch (2,22)>> shard_attn_scores batch (2,23)>> shard_attn_scores batch (2,24)>> shard_attn_scores batch (2,25)>> shard_attn_scores batch (2,26)>> shard_attn_scores batch (2,27)>> shard_attn_scores batch (2,28)>> shard_attn_scores batch (2,29)>> shard_attn_scores batch (2,30)>> shard_attn_scores batch (2,31)>> shard_attn_scores batch (2,32)>> shard_attn_scores batch (2,33)>> shard_attn_scores batch (2,34)>> shard_attn_scores batch (2,35)>> shard_attn_scores batch (2,36)>> shard_attn_scores batch (2,37)>> shard_attn_scores batch (2,38)>> shard_attn_scores batch (2,39)>> shard_attn_scores batch (2,40)>> shard_attn_scores batch (2,41)>> shard_attn_scores batch (2,42)>> shard_attn_scores batch (2,43)>> shard_attn_scores batch (2,44)>> shard_attn_scores batch (2,45)>> shard_attn_scores batch (2,46)>> shard_attn_scores batch (2,47)>> shard_attn_scores batch (2,48)>> shard_attn_scores batch (2,49)>> shard_attn_scores batch (3,0)>> shard_attn_scores batch (3,1)>> shard_attn_scores batch (3,2)>> shard_attn_scores batch (3,3)>> shard_attn_scores batch (3,4)>> shard_attn_scores batch (3,5)>> shard_attn_scores batch (3,6)>> shard_attn_scores batch (3,7)>> shard_attn_scores batch (3,8)>> shard_attn_scores batch (3,9)>> shard_attn_scores batch (3,10)>> shard_attn_scores batch (3,11)>> shard_attn_scores batch (3,12)>> shard_attn_scores batch (3,13)>> shard_attn_scores batch (3,14)>> shard_attn_scores batch (3,15)>> shard_attn_scores batch (3,16)>> shard_attn_scores batch (3,17)>> shard_attn_scores batch (3,18)>> shard_attn_scores batch (3,19)>> shard_attn_scores batch (3,20)>> shard_attn_scores batch (3,21)>> shard_attn_scores batch (3,22)>> shard_attn_scores batch (3,23)>> shard_attn_scores batch (3,24)>> shard_attn_scores batch (3,25)>> shard_attn_scores batch (3,26)>> shard_attn_scores batch (3,27)>> shard_attn_scores batch (3,28)>> shard_attn_scores batch (3,29)>> shard_attn_scores batch (3,30)>> shard_attn_scores batch (3,31)>> shard_attn_scores batch (3,32)>> shard_attn_scores batch (3,33)>> shard_attn_scores batch (3,34)>> shard_attn_scores batch (3,35)>> shard_attn_scores batch (3,36)>> shard_attn_scores batch (3,37)>> shard_attn_scores batch (3,38)>> shard_attn_scores batch (3,39)>> shard_attn_scores batch (3,40)>> shard_attn_scores batch (3,41)>> shard_attn_scores batch (3,42)>> shard_attn_scores batch (3,43)>> shard_attn_scores batch (3,44)>> shard_attn_scores batch (3,45)>> shard_attn_scores batch (3,46)>> shard_attn_scores batch (3,47)>> shard_attn_scores batch (3,48)>> shard_attn_scores batch (3,49)>> shard_attn_scores batch (4,0)>> shard_attn_scores batch (4,1)>> shard_attn_scores batch (4,2)>> shard_attn_scores batch (4,3)>> shard_attn_scores batch (4,4)>> shard_attn_scores batch (4,5)>> shard_attn_scores batch (4,6)>> shard_attn_scores batch (4,7)>> shard_attn_scores batch (4,8)>> shard_attn_scores batch (4,9)>> shard_attn_scores batch (4,10)>> shard_attn_scores batch (4,11)>> shard_attn_scores batch (4,12)>> shard_attn_scores batch (4,13)>> shard_attn_scores batch (4,14)>> shard_attn_scores batch (4,15)>> shard_attn_scores batch (4,16)>> shard_attn_scores batch (4,17)>> shard_attn_scores batch (4,18)>> shard_attn_scores batch (4,19)>> shard_attn_scores batch (4,20)>> shard_attn_scores batch (4,21)>> shard_attn_scores batch (4,22)>> shard_attn_scores batch (4,23)>> shard_attn_scores batch (4,24)>> shard_attn_scores batch (4,25)>> shard_attn_scores batch (4,26)>> shard_attn_scores batch (4,27)>> shard_attn_scores batch (4,28)>> shard_attn_scores batch (4,29)>> shard_attn_scores batch (4,30)>> shard_attn_scores batch (4,31)>> shard_attn_scores batch (4,32)>> shard_attn_scores batch (4,33)>> shard_attn_scores batch (4,34)>> shard_attn_scores batch (4,35)>> shard_attn_scores batch (4,36)>> shard_attn_scores batch (4,37)>> shard_attn_scores batch (4,38)>> shard_attn_scores batch (4,39)>> shard_attn_scores batch (4,40)>> shard_attn_scores batch (4,41)>> shard_attn_scores batch (4,42)>> shard_attn_scores batch (4,43)>> shard_attn_scores batch (4,44)>> shard_attn_scores batch (4,45)>> shard_attn_scores batch (4,46)>> shard_attn_scores batch (4,47)>> shard_attn_scores batch (4,48)>> shard_attn_scores batch (4,49)>> shard_attn_scores batch (5,0)>> shard_attn_scores batch (5,1)>> shard_attn_scores batch (5,2)>> shard_attn_scores batch (5,3)>> shard_attn_scores batch (5,4)>> shard_attn_scores batch (5,5)>> shard_attn_scores batch (5,6)>> shard_attn_scores batch (5,7)>> shard_attn_scores batch (5,8)>> shard_attn_scores batch (5,9)>> shard_attn_scores batch (5,10)>> shard_attn_scores batch (5,11)>> shard_attn_scores batch (5,12)>> shard_attn_scores batch (5,13)>> shard_attn_scores batch (5,14)>> shard_attn_scores batch (5,15)>> shard_attn_scores batch (5,16)>> shard_attn_scores batch (5,17)>> shard_attn_scores batch (5,18)>> shard_attn_scores batch (5,19)>> shard_attn_scores batch (5,20)>> shard_attn_scores batch (5,21)>> shard_attn_scores batch (5,22)>> shard_attn_scores batch (5,23)>> shard_attn_scores batch (5,24)>> shard_attn_scores batch (5,25)>> shard_attn_scores batch (5,26)>> shard_attn_scores batch (5,27)>> shard_attn_scores batch (5,28)>> shard_attn_scores batch (5,29)>> shard_attn_scores batch (5,30)>> shard_attn_scores batch (5,31)>> shard_attn_scores batch (5,32)>> shard_attn_scores batch (5,33)>> shard_attn_scores batch (5,34)>> shard_attn_scores batch (5,35)>> shard_attn_scores batch (5,36)>> shard_attn_scores batch (5,37)>> shard_attn_scores batch (5,38)>> shard_attn_scores batch (5,39)>> shard_attn_scores batch (5,40)>> shard_attn_scores batch (5,41)>> shard_attn_scores batch (5,42)>> shard_attn_scores batch (5,43)>> shard_attn_scores batch (5,44)>> shard_attn_scores batch (5,45)>> shard_attn_scores batch (5,46)>> shard_attn_scores batch (5,47)>> shard_attn_scores batch (5,48)>> shard_attn_scores batch (5,49)>> shard_attn_scores batch (6,0)>> shard_attn_scores batch (6,1)>> shard_attn_scores batch (6,2)>> shard_attn_scores batch (6,3)>> shard_attn_scores batch (6,4)>> shard_attn_scores batch (6,5)>> shard_attn_scores batch (6,6)>> shard_attn_scores batch (6,7)>> shard_attn_scores batch (6,8)>> shard_attn_scores batch (6,9)>> shard_attn_scores batch (6,10)>> shard_attn_scores batch (6,11)>> shard_attn_scores batch (6,12)>> shard_attn_scores batch (6,13)>> shard_attn_scores batch (6,14)>> shard_attn_scores batch (6,15)>> shard_attn_scores batch (6,16)>> shard_attn_scores batch (6,17)>> shard_attn_scores batch (6,18)>> shard_attn_scores batch (6,19)>> shard_attn_scores batch (6,20)>> shard_attn_scores batch (6,21)>> shard_attn_scores batch (6,22)>> shard_attn_scores batch (6,23)>> shard_attn_scores batch (6,24)>> shard_attn_scores batch (6,25)>> shard_attn_scores batch (6,26)>> shard_attn_scores batch (6,27)>> shard_attn_scores batch (6,28)>> shard_attn_scores batch (6,29)>> shard_attn_scores batch (6,30)>> shard_attn_scores batch (6,31)>> shard_attn_scores batch (6,32)>> shard_attn_scores batch (6,33)>> shard_attn_scores batch (6,34)>> shard_attn_scores batch (6,35)>> shard_attn_scores batch (6,36)>> shard_attn_scores batch (6,37)>> shard_attn_scores batch (6,38)>> shard_attn_scores batch (6,39)>> shard_attn_scores batch (6,40)>> shard_attn_scores batch (6,41)>> shard_attn_scores batch (6,42)>> shard_attn_scores batch (6,43)>> shard_attn_scores batch (6,44)>> shard_attn_scores batch (6,45)>> shard_attn_scores batch (6,46)>> shard_attn_scores batch (6,47)>> shard_attn_scores batch (6,48)>> shard_attn_scores batch (6,49)>> shard_attn_scores batch (7,0)>> shard_attn_scores batch (7,1)>> shard_attn_scores batch (7,2)>> shard_attn_scores batch (7,3)>> shard_attn_scores batch (7,4)>> shard_attn_scores batch (7,5)>> shard_attn_scores batch (7,6)>> shard_attn_scores batch (7,7)>> shard_attn_scores batch (7,8)>> shard_attn_scores batch (7,9)>> shard_attn_scores batch (7,10)>> shard_attn_scores batch (7,11)>> shard_attn_scores batch (7,12)>> shard_attn_scores batch (7,13)>> shard_attn_scores batch (7,14)>> shard_attn_scores batch (7,15)>> shard_attn_scores batch (7,16)>> shard_attn_scores batch (7,17)>> shard_attn_scores batch (7,18)>> shard_attn_scores batch (7,19)>> shard_attn_scores batch (7,20)>> shard_attn_scores batch (7,21)>> shard_attn_scores batch (7,22)>> shard_attn_scores batch (7,23)>> shard_attn_scores batch (7,24)>> shard_attn_scores batch (7,25)>> shard_attn_scores batch (7,26)>> shard_attn_scores batch (7,27)>> shard_attn_scores batch (7,28)>> shard_attn_scores batch (7,29)>> shard_attn_scores batch (7,30)>> shard_attn_scores batch (7,31)>> shard_attn_scores batch (7,32)>> shard_attn_scores batch (7,33)>> shard_attn_scores batch (7,34)>> shard_attn_scores batch (7,35)>> shard_attn_scores batch (7,36)>> shard_attn_scores batch (7,37)>> shard_attn_scores batch (7,38)>> shard_attn_scores batch (7,39)>> shard_attn_scores batch (7,40)>> shard_attn_scores batch (7,41)>> shard_attn_scores batch (7,42)>> shard_attn_scores batch (7,43)>> shard_attn_scores batch (7,44)>> shard_attn_scores batch (7,45)>> shard_attn_scores batch (7,46)>> shard_attn_scores batch (7,47)>> shard_attn_scores batch (7,48)>> shard_attn_scores batch (7,49)>> shard_attn_scores batch (8,0)>> shard_attn_scores batch (8,1)>> shard_attn_scores batch (8,2)>> shard_attn_scores batch (8,3)>> shard_attn_scores batch (8,4)>> shard_attn_scores batch (8,5)>> shard_attn_scores batch (8,6)>> shard_attn_scores batch (8,7)>> shard_attn_scores batch (8,8)>> shard_attn_scores batch (8,9)>> shard_attn_scores batch (8,10)>> shard_attn_scores batch (8,11)>> shard_attn_scores batch (8,12)>> shard_attn_scores batch (8,13)>> shard_attn_scores batch (8,14)>> shard_attn_scores batch (8,15)>> shard_attn_scores batch (8,16)>> shard_attn_scores batch (8,17)>> shard_attn_scores batch (8,18)>> shard_attn_scores batch (8,19)>> shard_attn_scores batch (8,20)>> shard_attn_scores batch (8,21)>> shard_attn_scores batch (8,22)>> shard_attn_scores batch (8,23)>> shard_attn_scores batch (8,24)>> shard_attn_scores batch (8,25)>> shard_attn_scores batch (8,26)>> shard_attn_scores batch (8,27)>> shard_attn_scores batch (8,28)>> shard_attn_scores batch (8,29)>> shard_attn_scores batch (8,30)>> shard_attn_scores batch (8,31)>> shard_attn_scores batch (8,32)>> shard_attn_scores batch (8,33)>> shard_attn_scores batch (8,34)>> shard_attn_scores batch (8,35)>> shard_attn_scores batch (8,36)>> shard_attn_scores batch (8,37)>> shard_attn_scores batch (8,38)>> shard_attn_scores batch (8,39)>> shard_attn_scores batch (8,40)>> shard_attn_scores batch (8,41)>> shard_attn_scores batch (8,42)>> shard_attn_scores batch (8,43)>> shard_attn_scores batch (8,44)>> shard_attn_scores batch (8,45)>> shard_attn_scores batch (8,46)>> shard_attn_scores batch (8,47)>> shard_attn_scores batch (8,48)>> shard_attn_scores batch (8,49)>> shard_attn_scores batch (9,0)>> shard_attn_scores batch (9,1)>> shard_attn_scores batch (9,2)>> shard_attn_scores batch (9,3)>> shard_attn_scores batch (9,4)>> shard_attn_scores batch (9,5)>> shard_attn_scores batch (9,6)>> shard_attn_scores batch (9,7)>> shard_attn_scores batch (9,8)>> shard_attn_scores batch (9,9)>> shard_attn_scores batch (9,10)>> shard_attn_scores batch (9,11)>> shard_attn_scores batch (9,12)>> shard_attn_scores batch (9,13)>> shard_attn_scores batch (9,14)>> shard_attn_scores batch (9,15)>> shard_attn_scores batch (9,16)>> shard_attn_scores batch (9,17)>> shard_attn_scores batch (9,18)>> shard_attn_scores batch (9,19)>> shard_attn_scores batch (9,20)>> shard_attn_scores batch (9,21)>> shard_attn_scores batch (9,22)>> shard_attn_scores batch (9,23)>> shard_attn_scores batch (9,24)>> shard_attn_scores batch (9,25)>> shard_attn_scores batch (9,26)>> shard_attn_scores batch (9,27)>> shard_attn_scores batch (9,28)>> shard_attn_scores batch (9,29)>> shard_attn_scores batch (9,30)>> shard_attn_scores batch (9,31)>> shard_attn_scores batch (9,32)>> shard_attn_scores batch (9,33)>> shard_attn_scores batch (9,34)>> shard_attn_scores batch (9,35)>> shard_attn_scores batch (9,36)>> shard_attn_scores batch (9,37)>> shard_attn_scores batch (9,38)>> shard_attn_scores batch (9,39)>> shard_attn_scores batch (9,40)>> shard_attn_scores batch (9,41)>> shard_attn_scores batch (9,42)>> shard_attn_scores batch (9,43)>> shard_attn_scores batch (9,44)>> shard_attn_scores batch (9,45)>> shard_attn_scores batch (9,46)>> shard_attn_scores batch (9,47)>> shard_attn_scores batch (9,48)>> shard_attn_scores batch (9,49)
calculate similarity time: 145.11244893074036
Image to text: 78.2 95.7 98.3 1.0 2.0 68.6
Text to image: 62.7 88.3 93.5 1.0 10.5 63.0
rsum: 516.8 ar: 90.7 ari: 81.5
>> shard_attn_scores batch (0,0)>> shard_attn_scores batch (0,1)>> shard_attn_scores batch (0,2)>> shard_attn_scores batch (0,3)>> shard_attn_scores batch (0,4)>> shard_attn_scores batch (0,5)>> shard_attn_scores batch (0,6)>> shard_attn_scores batch (0,7)>> shard_attn_scores batch (0,8)>> shard_attn_scores batch (0,9)>> shard_attn_scores batch (0,10)>> shard_attn_scores batch (0,11)>> shard_attn_scores batch (0,12)>> shard_attn_scores batch (0,13)>> shard_attn_scores batch (0,14)>> shard_attn_scores batch (0,15)>> shard_attn_scores batch (0,16)>> shard_attn_scores batch (0,17)>> shard_attn_scores batch (0,18)>> shard_attn_scores batch (0,19)>> shard_attn_scores batch (0,20)>> shard_attn_scores batch (0,21)>> shard_attn_scores batch (0,22)>> shard_attn_scores batch (0,23)>> shard_attn_scores batch (0,24)>> shard_attn_scores batch (0,25)>> shard_attn_scores batch (0,26)>> shard_attn_scores batch (0,27)>> shard_attn_scores batch (0,28)>> shard_attn_scores batch (0,29)>> shard_attn_scores batch (0,30)>> shard_attn_scores batch (0,31)>> shard_attn_scores batch (0,32)>> shard_attn_scores batch (0,33)>> shard_attn_scores batch (0,34)>> shard_attn_scores batch (0,35)>> shard_attn_scores batch (0,36)>> shard_attn_scores batch (0,37)>> shard_attn_scores batch (0,38)>> shard_attn_scores batch (0,39)>> shard_attn_scores batch (0,40)>> shard_attn_scores batch (0,41)>> shard_attn_scores batch (0,42)>> shard_attn_scores batch (0,43)>> shard_attn_scores batch (0,44)>> shard_attn_scores batch (0,45)>> shard_attn_scores batch (0,46)>> shard_attn_scores batch (0,47)>> shard_attn_scores batch (0,48)>> shard_attn_scores batch (0,49)>> shard_attn_scores batch (1,0)>> shard_attn_scores batch (1,1)>> shard_attn_scores batch (1,2)>> shard_attn_scores batch (1,3)>> shard_attn_scores batch (1,4)>> shard_attn_scores batch (1,5)>> shard_attn_scores batch (1,6)>> shard_attn_scores batch (1,7)>> shard_attn_scores batch (1,8)>> shard_attn_scores batch (1,9)>> shard_attn_scores batch (1,10)>> shard_attn_scores batch (1,11)>> shard_attn_scores batch (1,12)>> shard_attn_scores batch (1,13)>> shard_attn_scores batch (1,14)>> shard_attn_scores batch (1,15)>> shard_attn_scores batch (1,16)>> shard_attn_scores batch (1,17)>> shard_attn_scores batch (1,18)>> shard_attn_scores batch (1,19)>> shard_attn_scores batch (1,20)>> shard_attn_scores batch (1,21)>> shard_attn_scores batch (1,22)>> shard_attn_scores batch (1,23)>> shard_attn_scores batch (1,24)>> shard_attn_scores batch (1,25)>> shard_attn_scores batch (1,26)>> shard_attn_scores batch (1,27)>> shard_attn_scores batch (1,28)>> shard_attn_scores batch (1,29)>> shard_attn_scores batch (1,30)>> shard_attn_scores batch (1,31)>> shard_attn_scores batch (1,32)>> shard_attn_scores batch (1,33)>> shard_attn_scores batch (1,34)>> shard_attn_scores batch (1,35)>> shard_attn_scores batch (1,36)>> shard_attn_scores batch (1,37)>> shard_attn_scores batch (1,38)>> shard_attn_scores batch (1,39)>> shard_attn_scores batch (1,40)>> shard_attn_scores batch (1,41)>> shard_attn_scores batch (1,42)>> shard_attn_scores batch (1,43)>> shard_attn_scores batch (1,44)>> shard_attn_scores batch (1,45)>> shard_attn_scores batch (1,46)>> shard_attn_scores batch (1,47)>> shard_attn_scores batch (1,48)>> shard_attn_scores batch (1,49)>> shard_attn_scores batch (2,0)>> shard_attn_scores batch (2,1)>> shard_attn_scores batch (2,2)>> shard_attn_scores batch (2,3)>> shard_attn_scores batch (2,4)>> shard_attn_scores batch (2,5)>> shard_attn_scores batch (2,6)>> shard_attn_scores batch (2,7)>> shard_attn_scores batch (2,8)>> shard_attn_scores batch (2,9)>> shard_attn_scores batch (2,10)>> shard_attn_scores batch (2,11)>> shard_attn_scores batch (2,12)>> shard_attn_scores batch (2,13)>> shard_attn_scores batch (2,14)>> shard_attn_scores batch (2,15)>> shard_attn_scores batch (2,16)>> shard_attn_scores batch (2,17)>> shard_attn_scores batch (2,18)>> shard_attn_scores batch (2,19)>> shard_attn_scores batch (2,20)>> shard_attn_scores batch (2,21)>> shard_attn_scores batch (2,22)>> shard_attn_scores batch (2,23)>> shard_attn_scores batch (2,24)>> shard_attn_scores batch (2,25)>> shard_attn_scores batch (2,26)>> shard_attn_scores batch (2,27)>> shard_attn_scores batch (2,28)>> shard_attn_scores batch (2,29)>> shard_attn_scores batch (2,30)>> shard_attn_scores batch (2,31)>> shard_attn_scores batch (2,32)>> shard_attn_scores batch (2,33)>> shard_attn_scores batch (2,34)>> shard_attn_scores batch (2,35)>> shard_attn_scores batch (2,36)>> shard_attn_scores batch (2,37)>> shard_attn_scores batch (2,38)>> shard_attn_scores batch (2,39)>> shard_attn_scores batch (2,40)>> shard_attn_scores batch (2,41)>> shard_attn_scores batch (2,42)>> shard_attn_scores batch (2,43)>> shard_attn_scores batch (2,44)>> shard_attn_scores batch (2,45)>> shard_attn_scores batch (2,46)>> shard_attn_scores batch (2,47)>> shard_attn_scores batch (2,48)>> shard_attn_scores batch (2,49)>> shard_attn_scores batch (3,0)>> shard_attn_scores batch (3,1)>> shard_attn_scores batch (3,2)>> shard_attn_scores batch (3,3)>> shard_attn_scores batch (3,4)>> shard_attn_scores batch (3,5)>> shard_attn_scores batch (3,6)>> shard_attn_scores batch (3,7)>> shard_attn_scores batch (3,8)>> shard_attn_scores batch (3,9)>> shard_attn_scores batch (3,10)>> shard_attn_scores batch (3,11)>> shard_attn_scores batch (3,12)>> shard_attn_scores batch (3,13)>> shard_attn_scores batch (3,14)>> shard_attn_scores batch (3,15)>> shard_attn_scores batch (3,16)>> shard_attn_scores batch (3,17)>> shard_attn_scores batch (3,18)>> shard_attn_scores batch (3,19)>> shard_attn_scores batch (3,20)>> shard_attn_scores batch (3,21)>> shard_attn_scores batch (3,22)>> shard_attn_scores batch (3,23)>> shard_attn_scores batch (3,24)>> shard_attn_scores batch (3,25)>> shard_attn_scores batch (3,26)>> shard_attn_scores batch (3,27)>> shard_attn_scores batch (3,28)>> shard_attn_scores batch (3,29)>> shard_attn_scores batch (3,30)>> shard_attn_scores batch (3,31)>> shard_attn_scores batch (3,32)>> shard_attn_scores batch (3,33)>> shard_attn_scores batch (3,34)>> shard_attn_scores batch (3,35)>> shard_attn_scores batch (3,36)>> shard_attn_scores batch (3,37)>> shard_attn_scores batch (3,38)>> shard_attn_scores batch (3,39)>> shard_attn_scores batch (3,40)>> shard_attn_scores batch (3,41)>> shard_attn_scores batch (3,42)>> shard_attn_scores batch (3,43)>> shard_attn_scores batch (3,44)>> shard_attn_scores batch (3,45)>> shard_attn_scores batch (3,46)>> shard_attn_scores batch (3,47)>> shard_attn_scores batch (3,48)>> shard_attn_scores batch (3,49)>> shard_attn_scores batch (4,0)>> shard_attn_scores batch (4,1)>> shard_attn_scores batch (4,2)>> shard_attn_scores batch (4,3)>> shard_attn_scores batch (4,4)>> shard_attn_scores batch (4,5)>> shard_attn_scores batch (4,6)>> shard_attn_scores batch (4,7)>> shard_attn_scores batch (4,8)>> shard_attn_scores batch (4,9)>> shard_attn_scores batch (4,10)>> shard_attn_scores batch (4,11)>> shard_attn_scores batch (4,12)>> shard_attn_scores batch (4,13)>> shard_attn_scores batch (4,14)>> shard_attn_scores batch (4,15)>> shard_attn_scores batch (4,16)>> shard_attn_scores batch (4,17)>> shard_attn_scores batch (4,18)>> shard_attn_scores batch (4,19)>> shard_attn_scores batch (4,20)>> shard_attn_scores batch (4,21)>> shard_attn_scores batch (4,22)>> shard_attn_scores batch (4,23)>> shard_attn_scores batch (4,24)>> shard_attn_scores batch (4,25)>> shard_attn_scores batch (4,26)>> shard_attn_scores batch (4,27)>> shard_attn_scores batch (4,28)>> shard_attn_scores batch (4,29)>> shard_attn_scores batch (4,30)>> shard_attn_scores batch (4,31)>> shard_attn_scores batch (4,32)>> shard_attn_scores batch (4,33)>> shard_attn_scores batch (4,34)>> shard_attn_scores batch (4,35)>> shard_attn_scores batch (4,36)>> shard_attn_scores batch (4,37)>> shard_attn_scores batch (4,38)>> shard_attn_scores batch (4,39)>> shard_attn_scores batch (4,40)>> shard_attn_scores batch (4,41)>> shard_attn_scores batch (4,42)>> shard_attn_scores batch (4,43)>> shard_attn_scores batch (4,44)>> shard_attn_scores batch (4,45)>> shard_attn_scores batch (4,46)>> shard_attn_scores batch (4,47)>> shard_attn_scores batch (4,48)>> shard_attn_scores batch (4,49)>> shard_attn_scores batch (5,0)>> shard_attn_scores batch (5,1)>> shard_attn_scores batch (5,2)>> shard_attn_scores batch (5,3)>> shard_attn_scores batch (5,4)>> shard_attn_scores batch (5,5)>> shard_attn_scores batch (5,6)>> shard_attn_scores batch (5,7)>> shard_attn_scores batch (5,8)>> shard_attn_scores batch (5,9)>> shard_attn_scores batch (5,10)>> shard_attn_scores batch (5,11)>> shard_attn_scores batch (5,12)>> shard_attn_scores batch (5,13)>> shard_attn_scores batch (5,14)>> shard_attn_scores batch (5,15)>> shard_attn_scores batch (5,16)>> shard_attn_scores batch (5,17)>> shard_attn_scores batch (5,18)>> shard_attn_scores batch (5,19)>> shard_attn_scores batch (5,20)>> shard_attn_scores batch (5,21)>> shard_attn_scores batch (5,22)>> shard_attn_scores batch (5,23)>> shard_attn_scores batch (5,24)>> shard_attn_scores batch (5,25)>> shard_attn_scores batch (5,26)>> shard_attn_scores batch (5,27)>> shard_attn_scores batch (5,28)>> shard_attn_scores batch (5,29)>> shard_attn_scores batch (5,30)>> shard_attn_scores batch (5,31)>> shard_attn_scores batch (5,32)>> shard_attn_scores batch (5,33)>> shard_attn_scores batch (5,34)>> shard_attn_scores batch (5,35)>> shard_attn_scores batch (5,36)>> shard_attn_scores batch (5,37)>> shard_attn_scores batch (5,38)>> shard_attn_scores batch (5,39)>> shard_attn_scores batch (5,40)>> shard_attn_scores batch (5,41)>> shard_attn_scores batch (5,42)>> shard_attn_scores batch (5,43)>> shard_attn_scores batch (5,44)>> shard_attn_scores batch (5,45)>> shard_attn_scores batch (5,46)>> shard_attn_scores batch (5,47)>> shard_attn_scores batch (5,48)>> shard_attn_scores batch (5,49)>> shard_attn_scores batch (6,0)>> shard_attn_scores batch (6,1)>> shard_attn_scores batch (6,2)>> shard_attn_scores batch (6,3)>> shard_attn_scores batch (6,4)>> shard_attn_scores batch (6,5)>> shard_attn_scores batch (6,6)>> shard_attn_scores batch (6,7)>> shard_attn_scores batch (6,8)>> shard_attn_scores batch (6,9)>> shard_attn_scores batch (6,10)>> shard_attn_scores batch (6,11)>> shard_attn_scores batch (6,12)>> shard_attn_scores batch (6,13)>> shard_attn_scores batch (6,14)>> shard_attn_scores batch (6,15)>> shard_attn_scores batch (6,16)>> shard_attn_scores batch (6,17)>> shard_attn_scores batch (6,18)>> shard_attn_scores batch (6,19)>> shard_attn_scores batch (6,20)>> shard_attn_scores batch (6,21)>> shard_attn_scores batch (6,22)>> shard_attn_scores batch (6,23)>> shard_attn_scores batch (6,24)>> shard_attn_scores batch (6,25)>> shard_attn_scores batch (6,26)>> shard_attn_scores batch (6,27)>> shard_attn_scores batch (6,28)>> shard_attn_scores batch (6,29)>> shard_attn_scores batch (6,30)>> shard_attn_scores batch (6,31)>> shard_attn_scores batch (6,32)>> shard_attn_scores batch (6,33)>> shard_attn_scores batch (6,34)>> shard_attn_scores batch (6,35)>> shard_attn_scores batch (6,36)>> shard_attn_scores batch (6,37)>> shard_attn_scores batch (6,38)>> shard_attn_scores batch (6,39)>> shard_attn_scores batch (6,40)>> shard_attn_scores batch (6,41)>> shard_attn_scores batch (6,42)>> shard_attn_scores batch (6,43)>> shard_attn_scores batch (6,44)>> shard_attn_scores batch (6,45)>> shard_attn_scores batch (6,46)>> shard_attn_scores batch (6,47)>> shard_attn_scores batch (6,48)>> shard_attn_scores batch (6,49)>> shard_attn_scores batch (7,0)>> shard_attn_scores batch (7,1)>> shard_attn_scores batch (7,2)>> shard_attn_scores batch (7,3)>> shard_attn_scores batch (7,4)>> shard_attn_scores batch (7,5)>> shard_attn_scores batch (7,6)>> shard_attn_scores batch (7,7)>> shard_attn_scores batch (7,8)>> shard_attn_scores batch (7,9)>> shard_attn_scores batch (7,10)>> shard_attn_scores batch (7,11)>> shard_attn_scores batch (7,12)>> shard_attn_scores batch (7,13)>> shard_attn_scores batch (7,14)>> shard_attn_scores batch (7,15)>> shard_attn_scores batch (7,16)>> shard_attn_scores batch (7,17)>> shard_attn_scores batch (7,18)>> shard_attn_scores batch (7,19)>> shard_attn_scores batch (7,20)>> shard_attn_scores batch (7,21)>> shard_attn_scores batch (7,22)>> shard_attn_scores batch (7,23)>> shard_attn_scores batch (7,24)>> shard_attn_scores batch (7,25)>> shard_attn_scores batch (7,26)>> shard_attn_scores batch (7,27)>> shard_attn_scores batch (7,28)>> shard_attn_scores batch (7,29)>> shard_attn_scores batch (7,30)>> shard_attn_scores batch (7,31)>> shard_attn_scores batch (7,32)>> shard_attn_scores batch (7,33)>> shard_attn_scores batch (7,34)>> shard_attn_scores batch (7,35)>> shard_attn_scores batch (7,36)>> shard_attn_scores batch (7,37)>> shard_attn_scores batch (7,38)>> shard_attn_scores batch (7,39)>> shard_attn_scores batch (7,40)>> shard_attn_scores batch (7,41)>> shard_attn_scores batch (7,42)>> shard_attn_scores batch (7,43)>> shard_attn_scores batch (7,44)>> shard_attn_scores batch (7,45)>> shard_attn_scores batch (7,46)>> shard_attn_scores batch (7,47)>> shard_attn_scores batch (7,48)>> shard_attn_scores batch (7,49)>> shard_attn_scores batch (8,0)>> shard_attn_scores batch (8,1)>> shard_attn_scores batch (8,2)>> shard_attn_scores batch (8,3)>> shard_attn_scores batch (8,4)>> shard_attn_scores batch (8,5)>> shard_attn_scores batch (8,6)>> shard_attn_scores batch (8,7)>> shard_attn_scores batch (8,8)>> shard_attn_scores batch (8,9)>> shard_attn_scores batch (8,10)>> shard_attn_scores batch (8,11)>> shard_attn_scores batch (8,12)>> shard_attn_scores batch (8,13)>> shard_attn_scores batch (8,14)>> shard_attn_scores batch (8,15)>> shard_attn_scores batch (8,16)>> shard_attn_scores batch (8,17)>> shard_attn_scores batch (8,18)>> shard_attn_scores batch (8,19)>> shard_attn_scores batch (8,20)>> shard_attn_scores batch (8,21)>> shard_attn_scores batch (8,22)>> shard_attn_scores batch (8,23)>> shard_attn_scores batch (8,24)>> shard_attn_scores batch (8,25)>> shard_attn_scores batch (8,26)>> shard_attn_scores batch (8,27)>> shard_attn_scores batch (8,28)>> shard_attn_scores batch (8,29)>> shard_attn_scores batch (8,30)>> shard_attn_scores batch (8,31)>> shard_attn_scores batch (8,32)>> shard_attn_scores batch (8,33)>> shard_attn_scores batch (8,34)>> shard_attn_scores batch (8,35)>> shard_attn_scores batch (8,36)>> shard_attn_scores batch (8,37)>> shard_attn_scores batch (8,38)>> shard_attn_scores batch (8,39)>> shard_attn_scores batch (8,40)>> shard_attn_scores batch (8,41)>> shard_attn_scores batch (8,42)>> shard_attn_scores batch (8,43)>> shard_attn_scores batch (8,44)>> shard_attn_scores batch (8,45)>> shard_attn_scores batch (8,46)>> shard_attn_scores batch (8,47)>> shard_attn_scores batch (8,48)>> shard_attn_scores batch (8,49)>> shard_attn_scores batch (9,0)>> shard_attn_scores batch (9,1)>> shard_attn_scores batch (9,2)>> shard_attn_scores batch (9,3)>> shard_attn_scores batch (9,4)>> shard_attn_scores batch (9,5)>> shard_attn_scores batch (9,6)>> shard_attn_scores batch (9,7)>> shard_attn_scores batch (9,8)>> shard_attn_scores batch (9,9)>> shard_attn_scores batch (9,10)>> shard_attn_scores batch (9,11)>> shard_attn_scores batch (9,12)>> shard_attn_scores batch (9,13)>> shard_attn_scores batch (9,14)>> shard_attn_scores batch (9,15)>> shard_attn_scores batch (9,16)>> shard_attn_scores batch (9,17)>> shard_attn_scores batch (9,18)>> shard_attn_scores batch (9,19)>> shard_attn_scores batch (9,20)>> shard_attn_scores batch (9,21)>> shard_attn_scores batch (9,22)>> shard_attn_scores batch (9,23)>> shard_attn_scores batch (9,24)>> shard_attn_scores batch (9,25)>> shard_attn_scores batch (9,26)>> shard_attn_scores batch (9,27)>> shard_attn_scores batch (9,28)>> shard_attn_scores batch (9,29)>> shard_attn_scores batch (9,30)>> shard_attn_scores batch (9,31)>> shard_attn_scores batch (9,32)>> shard_attn_scores batch (9,33)>> shard_attn_scores batch (9,34)>> shard_attn_scores batch (9,35)>> shard_attn_scores batch (9,36)>> shard_attn_scores batch (9,37)>> shard_attn_scores batch (9,38)>> shard_attn_scores batch (9,39)>> shard_attn_scores batch (9,40)>> shard_attn_scores batch (9,41)>> shard_attn_scores batch (9,42)>> shard_attn_scores batch (9,43)>> shard_attn_scores batch (9,44)>> shard_attn_scores batch (9,45)>> shard_attn_scores batch (9,46)>> shard_attn_scores batch (9,47)>> shard_attn_scores batch (9,48)>> shard_attn_scores batch (9,49)
calculate similarity time: 144.00972890853882
Image to text: 77.2 95.3 98.7 1.0 1.8 68.8
Text to image: 60.4 88.7 93.9 1.0 8.0 62.9
rsum: 514.2 ar: 90.4 ari: 81.0
>> shard_attn_scores batch (0,0)>> shard_attn_scores batch (0,1)>> shard_attn_scores batch (0,2)>> shard_attn_scores batch (0,3)>> shard_attn_scores batch (0,4)>> shard_attn_scores batch (0,5)>> shard_attn_scores batch (0,6)>> shard_attn_scores batch (0,7)>> shard_attn_scores batch (0,8)>> shard_attn_scores batch (0,9)>> shard_attn_scores batch (0,10)>> shard_attn_scores batch (0,11)>> shard_attn_scores batch (0,12)>> shard_attn_scores batch (0,13)>> shard_attn_scores batch (0,14)>> shard_attn_scores batch (0,15)>> shard_attn_scores batch (0,16)>> shard_attn_scores batch (0,17)>> shard_attn_scores batch (0,18)>> shard_attn_scores batch (0,19)>> shard_attn_scores batch (0,20)>> shard_attn_scores batch (0,21)>> shard_attn_scores batch (0,22)>> shard_attn_scores batch (0,23)>> shard_attn_scores batch (0,24)>> shard_attn_scores batch (0,25)>> shard_attn_scores batch (0,26)>> shard_attn_scores batch (0,27)>> shard_attn_scores batch (0,28)>> shard_attn_scores batch (0,29)>> shard_attn_scores batch (0,30)>> shard_attn_scores batch (0,31)>> shard_attn_scores batch (0,32)>> shard_attn_scores batch (0,33)>> shard_attn_scores batch (0,34)>> shard_attn_scores batch (0,35)>> shard_attn_scores batch (0,36)>> shard_attn_scores batch (0,37)>> shard_attn_scores batch (0,38)>> shard_attn_scores batch (0,39)>> shard_attn_scores batch (0,40)>> shard_attn_scores batch (0,41)>> shard_attn_scores batch (0,42)>> shard_attn_scores batch (0,43)>> shard_attn_scores batch (0,44)>> shard_attn_scores batch (0,45)>> shard_attn_scores batch (0,46)>> shard_attn_scores batch (0,47)>> shard_attn_scores batch (0,48)>> shard_attn_scores batch (0,49)>> shard_attn_scores batch (1,0)>> shard_attn_scores batch (1,1)>> shard_attn_scores batch (1,2)>> shard_attn_scores batch (1,3)>> shard_attn_scores batch (1,4)>> shard_attn_scores batch (1,5)>> shard_attn_scores batch (1,6)>> shard_attn_scores batch (1,7)>> shard_attn_scores batch (1,8)>> shard_attn_scores batch (1,9)>> shard_attn_scores batch (1,10)>> shard_attn_scores batch (1,11)>> shard_attn_scores batch (1,12)>> shard_attn_scores batch (1,13)>> shard_attn_scores batch (1,14)>> shard_attn_scores batch (1,15)>> shard_attn_scores batch (1,16)>> shard_attn_scores batch (1,17)>> shard_attn_scores batch (1,18)>> shard_attn_scores batch (1,19)>> shard_attn_scores batch (1,20)>> shard_attn_scores batch (1,21)>> shard_attn_scores batch (1,22)>> shard_attn_scores batch (1,23)>> shard_attn_scores batch (1,24)>> shard_attn_scores batch (1,25)>> shard_attn_scores batch (1,26)>> shard_attn_scores batch (1,27)>> shard_attn_scores batch (1,28)>> shard_attn_scores batch (1,29)>> shard_attn_scores batch (1,30)>> shard_attn_scores batch (1,31)>> shard_attn_scores batch (1,32)>> shard_attn_scores batch (1,33)>> shard_attn_scores batch (1,34)>> shard_attn_scores batch (1,35)>> shard_attn_scores batch (1,36)>> shard_attn_scores batch (1,37)>> shard_attn_scores batch (1,38)>> shard_attn_scores batch (1,39)>> shard_attn_scores batch (1,40)>> shard_attn_scores batch (1,41)>> shard_attn_scores batch (1,42)>> shard_attn_scores batch (1,43)>> shard_attn_scores batch (1,44)>> shard_attn_scores batch (1,45)>> shard_attn_scores batch (1,46)>> shard_attn_scores batch (1,47)>> shard_attn_scores batch (1,48)>> shard_attn_scores batch (1,49)>> shard_attn_scores batch (2,0)>> shard_attn_scores batch (2,1)>> shard_attn_scores batch (2,2)>> shard_attn_scores batch (2,3)>> shard_attn_scores batch (2,4)>> shard_attn_scores batch (2,5)>> shard_attn_scores batch (2,6)>> shard_attn_scores batch (2,7)>> shard_attn_scores batch (2,8)>> shard_attn_scores batch (2,9)>> shard_attn_scores batch (2,10)>> shard_attn_scores batch (2,11)>> shard_attn_scores batch (2,12)>> shard_attn_scores batch (2,13)>> shard_attn_scores batch (2,14)>> shard_attn_scores batch (2,15)>> shard_attn_scores batch (2,16)>> shard_attn_scores batch (2,17)>> shard_attn_scores batch (2,18)>> shard_attn_scores batch (2,19)>> shard_attn_scores batch (2,20)>> shard_attn_scores batch (2,21)>> shard_attn_scores batch (2,22)>> shard_attn_scores batch (2,23)>> shard_attn_scores batch (2,24)>> shard_attn_scores batch (2,25)>> shard_attn_scores batch (2,26)>> shard_attn_scores batch (2,27)>> shard_attn_scores batch (2,28)>> shard_attn_scores batch (2,29)>> shard_attn_scores batch (2,30)>> shard_attn_scores batch (2,31)>> shard_attn_scores batch (2,32)>> shard_attn_scores batch (2,33)>> shard_attn_scores batch (2,34)>> shard_attn_scores batch (2,35)>> shard_attn_scores batch (2,36)>> shard_attn_scores batch (2,37)>> shard_attn_scores batch (2,38)>> shard_attn_scores batch (2,39)>> shard_attn_scores batch (2,40)>> shard_attn_scores batch (2,41)>> shard_attn_scores batch (2,42)>> shard_attn_scores batch (2,43)>> shard_attn_scores batch (2,44)>> shard_attn_scores batch (2,45)>> shard_attn_scores batch (2,46)>> shard_attn_scores batch (2,47)>> shard_attn_scores batch (2,48)>> shard_attn_scores batch (2,49)>> shard_attn_scores batch (3,0)>> shard_attn_scores batch (3,1)>> shard_attn_scores batch (3,2)>> shard_attn_scores batch (3,3)>> shard_attn_scores batch (3,4)>> shard_attn_scores batch (3,5)>> shard_attn_scores batch (3,6)>> shard_attn_scores batch (3,7)>> shard_attn_scores batch (3,8)>> shard_attn_scores batch (3,9)>> shard_attn_scores batch (3,10)>> shard_attn_scores batch (3,11)>> shard_attn_scores batch (3,12)>> shard_attn_scores batch (3,13)>> shard_attn_scores batch (3,14)>> shard_attn_scores batch (3,15)>> shard_attn_scores batch (3,16)>> shard_attn_scores batch (3,17)>> shard_attn_scores batch (3,18)>> shard_attn_scores batch (3,19)>> shard_attn_scores batch (3,20)>> shard_attn_scores batch (3,21)>> shard_attn_scores batch (3,22)>> shard_attn_scores batch (3,23)>> shard_attn_scores batch (3,24)>> shard_attn_scores batch (3,25)>> shard_attn_scores batch (3,26)>> shard_attn_scores batch (3,27)>> shard_attn_scores batch (3,28)>> shard_attn_scores batch (3,29)>> shard_attn_scores batch (3,30)>> shard_attn_scores batch (3,31)>> shard_attn_scores batch (3,32)>> shard_attn_scores batch (3,33)>> shard_attn_scores batch (3,34)>> shard_attn_scores batch (3,35)>> shard_attn_scores batch (3,36)>> shard_attn_scores batch (3,37)>> shard_attn_scores batch (3,38)>> shard_attn_scores batch (3,39)>> shard_attn_scores batch (3,40)>> shard_attn_scores batch (3,41)>> shard_attn_scores batch (3,42)>> shard_attn_scores batch (3,43)>> shard_attn_scores batch (3,44)>> shard_attn_scores batch (3,45)>> shard_attn_scores batch (3,46)>> shard_attn_scores batch (3,47)>> shard_attn_scores batch (3,48)>> shard_attn_scores batch (3,49)>> shard_attn_scores batch (4,0)>> shard_attn_scores batch (4,1)>> shard_attn_scores batch (4,2)>> shard_attn_scores batch (4,3)>> shard_attn_scores batch (4,4)>> shard_attn_scores batch (4,5)>> shard_attn_scores batch (4,6)>> shard_attn_scores batch (4,7)>> shard_attn_scores batch (4,8)>> shard_attn_scores batch (4,9)>> shard_attn_scores batch (4,10)>> shard_attn_scores batch (4,11)>> shard_attn_scores batch (4,12)>> shard_attn_scores batch (4,13)>> shard_attn_scores batch (4,14)>> shard_attn_scores batch (4,15)>> shard_attn_scores batch (4,16)>> shard_attn_scores batch (4,17)>> shard_attn_scores batch (4,18)>> shard_attn_scores batch (4,19)>> shard_attn_scores batch (4,20)>> shard_attn_scores batch (4,21)>> shard_attn_scores batch (4,22)>> shard_attn_scores batch (4,23)>> shard_attn_scores batch (4,24)>> shard_attn_scores batch (4,25)>> shard_attn_scores batch (4,26)>> shard_attn_scores batch (4,27)>> shard_attn_scores batch (4,28)>> shard_attn_scores batch (4,29)>> shard_attn_scores batch (4,30)>> shard_attn_scores batch (4,31)>> shard_attn_scores batch (4,32)>> shard_attn_scores batch (4,33)>> shard_attn_scores batch (4,34)>> shard_attn_scores batch (4,35)>> shard_attn_scores batch (4,36)>> shard_attn_scores batch (4,37)>> shard_attn_scores batch (4,38)>> shard_attn_scores batch (4,39)>> shard_attn_scores batch (4,40)>> shard_attn_scores batch (4,41)>> shard_attn_scores batch (4,42)>> shard_attn_scores batch (4,43)>> shard_attn_scores batch (4,44)>> shard_attn_scores batch (4,45)>> shard_attn_scores batch (4,46)>> shard_attn_scores batch (4,47)>> shard_attn_scores batch (4,48)>> shard_attn_scores batch (4,49)>> shard_attn_scores batch (5,0)>> shard_attn_scores batch (5,1)>> shard_attn_scores batch (5,2)>> shard_attn_scores batch (5,3)>> shard_attn_scores batch (5,4)>> shard_attn_scores batch (5,5)>> shard_attn_scores batch (5,6)>> shard_attn_scores batch (5,7)>> shard_attn_scores batch (5,8)>> shard_attn_scores batch (5,9)>> shard_attn_scores batch (5,10)>> shard_attn_scores batch (5,11)>> shard_attn_scores batch (5,12)>> shard_attn_scores batch (5,13)>> shard_attn_scores batch (5,14)>> shard_attn_scores batch (5,15)>> shard_attn_scores batch (5,16)>> shard_attn_scores batch (5,17)>> shard_attn_scores batch (5,18)>> shard_attn_scores batch (5,19)>> shard_attn_scores batch (5,20)>> shard_attn_scores batch (5,21)>> shard_attn_scores batch (5,22)>> shard_attn_scores batch (5,23)>> shard_attn_scores batch (5,24)>> shard_attn_scores batch (5,25)>> shard_attn_scores batch (5,26)>> shard_attn_scores batch (5,27)>> shard_attn_scores batch (5,28)>> shard_attn_scores batch (5,29)>> shard_attn_scores batch (5,30)>> shard_attn_scores batch (5,31)>> shard_attn_scores batch (5,32)>> shard_attn_scores batch (5,33)>> shard_attn_scores batch (5,34)>> shard_attn_scores batch (5,35)>> shard_attn_scores batch (5,36)>> shard_attn_scores batch (5,37)>> shard_attn_scores batch (5,38)>> shard_attn_scores batch (5,39)>> shard_attn_scores batch (5,40)>> shard_attn_scores batch (5,41)>> shard_attn_scores batch (5,42)>> shard_attn_scores batch (5,43)>> shard_attn_scores batch (5,44)>> shard_attn_scores batch (5,45)>> shard_attn_scores batch (5,46)>> shard_attn_scores batch (5,47)>> shard_attn_scores batch (5,48)>> shard_attn_scores batch (5,49)>> shard_attn_scores batch (6,0)>> shard_attn_scores batch (6,1)>> shard_attn_scores batch (6,2)>> shard_attn_scores batch (6,3)>> shard_attn_scores batch (6,4)>> shard_attn_scores batch (6,5)>> shard_attn_scores batch (6,6)>> shard_attn_scores batch (6,7)>> shard_attn_scores batch (6,8)>> shard_attn_scores batch (6,9)>> shard_attn_scores batch (6,10)>> shard_attn_scores batch (6,11)>> shard_attn_scores batch (6,12)>> shard_attn_scores batch (6,13)>> shard_attn_scores batch (6,14)>> shard_attn_scores batch (6,15)>> shard_attn_scores batch (6,16)>> shard_attn_scores batch (6,17)>> shard_attn_scores batch (6,18)>> shard_attn_scores batch (6,19)>> shard_attn_scores batch (6,20)>> shard_attn_scores batch (6,21)>> shard_attn_scores batch (6,22)>> shard_attn_scores batch (6,23)>> shard_attn_scores batch (6,24)>> shard_attn_scores batch (6,25)>> shard_attn_scores batch (6,26)>> shard_attn_scores batch (6,27)>> shard_attn_scores batch (6,28)>> shard_attn_scores batch (6,29)>> shard_attn_scores batch (6,30)>> shard_attn_scores batch (6,31)>> shard_attn_scores batch (6,32)>> shard_attn_scores batch (6,33)>> shard_attn_scores batch (6,34)>> shard_attn_scores batch (6,35)>> shard_attn_scores batch (6,36)>> shard_attn_scores batch (6,37)>> shard_attn_scores batch (6,38)>> shard_attn_scores batch (6,39)>> shard_attn_scores batch (6,40)>> shard_attn_scores batch (6,41)>> shard_attn_scores batch (6,42)>> shard_attn_scores batch (6,43)>> shard_attn_scores batch (6,44)>> shard_attn_scores batch (6,45)>> shard_attn_scores batch (6,46)>> shard_attn_scores batch (6,47)>> shard_attn_scores batch (6,48)>> shard_attn_scores batch (6,49)>> shard_attn_scores batch (7,0)>> shard_attn_scores batch (7,1)>> shard_attn_scores batch (7,2)>> shard_attn_scores batch (7,3)>> shard_attn_scores batch (7,4)>> shard_attn_scores batch (7,5)>> shard_attn_scores batch (7,6)>> shard_attn_scores batch (7,7)>> shard_attn_scores batch (7,8)>> shard_attn_scores batch (7,9)>> shard_attn_scores batch (7,10)>> shard_attn_scores batch (7,11)>> shard_attn_scores batch (7,12)>> shard_attn_scores batch (7,13)>> shard_attn_scores batch (7,14)>> shard_attn_scores batch (7,15)>> shard_attn_scores batch (7,16)>> shard_attn_scores batch (7,17)>> shard_attn_scores batch (7,18)>> shard_attn_scores batch (7,19)>> shard_attn_scores batch (7,20)>> shard_attn_scores batch (7,21)>> shard_attn_scores batch (7,22)>> shard_attn_scores batch (7,23)>> shard_attn_scores batch (7,24)>> shard_attn_scores batch (7,25)>> shard_attn_scores batch (7,26)>> shard_attn_scores batch (7,27)>> shard_attn_scores batch (7,28)>> shard_attn_scores batch (7,29)>> shard_attn_scores batch (7,30)>> shard_attn_scores batch (7,31)>> shard_attn_scores batch (7,32)>> shard_attn_scores batch (7,33)>> shard_attn_scores batch (7,34)>> shard_attn_scores batch (7,35)>> shard_attn_scores batch (7,36)>> shard_attn_scores batch (7,37)>> shard_attn_scores batch (7,38)>> shard_attn_scores batch (7,39)>> shard_attn_scores batch (7,40)>> shard_attn_scores batch (7,41)>> shard_attn_scores batch (7,42)>> shard_attn_scores batch (7,43)>> shard_attn_scores batch (7,44)>> shard_attn_scores batch (7,45)>> shard_attn_scores batch (7,46)>> shard_attn_scores batch (7,47)>> shard_attn_scores batch (7,48)>> shard_attn_scores batch (7,49)>> shard_attn_scores batch (8,0)>> shard_attn_scores batch (8,1)>> shard_attn_scores batch (8,2)>> shard_attn_scores batch (8,3)>> shard_attn_scores batch (8,4)>> shard_attn_scores batch (8,5)>> shard_attn_scores batch (8,6)>> shard_attn_scores batch (8,7)>> shard_attn_scores batch (8,8)>> shard_attn_scores batch (8,9)>> shard_attn_scores batch (8,10)>> shard_attn_scores batch (8,11)>> shard_attn_scores batch (8,12)>> shard_attn_scores batch (8,13)>> shard_attn_scores batch (8,14)>> shard_attn_scores batch (8,15)>> shard_attn_scores batch (8,16)>> shard_attn_scores batch (8,17)>> shard_attn_scores batch (8,18)>> shard_attn_scores batch (8,19)>> shard_attn_scores batch (8,20)>> shard_attn_scores batch (8,21)>> shard_attn_scores batch (8,22)>> shard_attn_scores batch (8,23)>> shard_attn_scores batch (8,24)>> shard_attn_scores batch (8,25)>> shard_attn_scores batch (8,26)>> shard_attn_scores batch (8,27)>> shard_attn_scores batch (8,28)>> shard_attn_scores batch (8,29)>> shard_attn_scores batch (8,30)>> shard_attn_scores batch (8,31)>> shard_attn_scores batch (8,32)>> shard_attn_scores batch (8,33)>> shard_attn_scores batch (8,34)>> shard_attn_scores batch (8,35)>> shard_attn_scores batch (8,36)>> shard_attn_scores batch (8,37)>> shard_attn_scores batch (8,38)>> shard_attn_scores batch (8,39)>> shard_attn_scores batch (8,40)>> shard_attn_scores batch (8,41)>> shard_attn_scores batch (8,42)>> shard_attn_scores batch (8,43)>> shard_attn_scores batch (8,44)>> shard_attn_scores batch (8,45)>> shard_attn_scores batch (8,46)>> shard_attn_scores batch (8,47)>> shard_attn_scores batch (8,48)>> shard_attn_scores batch (8,49)>> shard_attn_scores batch (9,0)>> shard_attn_scores batch (9,1)>> shard_attn_scores batch (9,2)>> shard_attn_scores batch (9,3)>> shard_attn_scores batch (9,4)>> shard_attn_scores batch (9,5)>> shard_attn_scores batch (9,6)>> shard_attn_scores batch (9,7)>> shard_attn_scores batch (9,8)>> shard_attn_scores batch (9,9)>> shard_attn_scores batch (9,10)>> shard_attn_scores batch (9,11)>> shard_attn_scores batch (9,12)>> shard_attn_scores batch (9,13)>> shard_attn_scores batch (9,14)>> shard_attn_scores batch (9,15)>> shard_attn_scores batch (9,16)>> shard_attn_scores batch (9,17)>> shard_attn_scores batch (9,18)>> shard_attn_scores batch (9,19)>> shard_attn_scores batch (9,20)>> shard_attn_scores batch (9,21)>> shard_attn_scores batch (9,22)>> shard_attn_scores batch (9,23)>> shard_attn_scores batch (9,24)>> shard_attn_scores batch (9,25)>> shard_attn_scores batch (9,26)>> shard_attn_scores batch (9,27)>> shard_attn_scores batch (9,28)>> shard_attn_scores batch (9,29)>> shard_attn_scores batch (9,30)>> shard_attn_scores batch (9,31)>> shard_attn_scores batch (9,32)>> shard_attn_scores batch (9,33)>> shard_attn_scores batch (9,34)>> shard_attn_scores batch (9,35)>> shard_attn_scores batch (9,36)>> shard_attn_scores batch (9,37)>> shard_attn_scores batch (9,38)>> shard_attn_scores batch (9,39)>> shard_attn_scores batch (9,40)>> shard_attn_scores batch (9,41)>> shard_attn_scores batch (9,42)>> shard_attn_scores batch (9,43)>> shard_attn_scores batch (9,44)>> shard_attn_scores batch (9,45)>> shard_attn_scores batch (9,46)>> shard_attn_scores batch (9,47)>> shard_attn_scores batch (9,48)>> shard_attn_scores batch (9,49)
calculate similarity time: 137.37263703346252
Image to text: 78.3 95.8 98.7 1.0 1.7 68.5
Text to image: 63.1 89.6 94.2 1.0 7.3 62.7
rsum: 519.6 ar: 90.9 ari: 82.3
-----------------------------------
Mean metrics: 
rsum: 545.0
Average i2t Recall: 81.7
Image to text: 78.0 95.8 98.6 1.0 1.8 68.5
Average t2i Recall: 517.6
Text to image: 62.6 88.8 93.7 1.0 9.1 62.8
